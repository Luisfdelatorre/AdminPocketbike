import{r as t,v as E,w as I,j as e,x as M,y as L,z as _}from"./main-CfsT50y0.js";import{P as A}from"./Users-Dlm17aJ-.js";import{U as F}from"./users-CYM2wYj2.js";import{c as y}from"./createLucideIcon-BVLfzT-S.js";import{S as $}from"./search-CPdBVXh6.js";import{X as q}from"./x-B5cEk_pk.js";import"./modulepreload-polyfill-B5Qt9EMX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],R=y("trash-2",P);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],D=y("user-plus",z),K=()=>{const[v,g]=t.useState([]),[x,f]=t.useState([]),[N,p]=t.useState(!0),[w,c]=t.useState(!1),[o,U]=t.useState(""),[l,d]=t.useState(!1),[b,m]=t.useState(null),[r,n]=t.useState({name:"",email:"",password:"",role:"viewer",companyId:""});t.useEffect(()=>{h()},[]);const h=async()=>{p(!0);try{const[s,a]=await Promise.all([E(),I()]);s.success&&g(s.data),a.success&&f(a.data)}catch(s){console.error("Error loading data:",s),alert("Error loading data")}finally{p(!1)}},u=()=>{n({name:"",email:"",password:"",role:"viewer",companyId:""}),d(!1),m(null),c(!1)},C=s=>{var a;n({name:s.name,email:s.email,password:"",role:s.role,companyId:s.companyId||((a=x.find(i=>i.name===s.companyName))==null?void 0:a._id)||""}),d(!0),m(s._id),c(!0)},k=async s=>{s.preventDefault();try{let a;if(l){const i={...r};i.password||delete i.password,a=await L(b,i)}else a=await _(r);a.success?(alert(`User ${l?"updated":"created"} successfully`),u(),h()):alert(a.error||`Failed to ${l?"update":"create"} user`)}catch(a){console.error(a),alert(`Error ${l?"updating":"creating"} user`)}},S=async s=>{if(confirm("Are you sure you want to delete this user?"))try{(await M(s)).success?h():alert("Failed to delete user")}catch(a){console.error(a),alert("Error deleting user")}},j=v.filter(s=>s.name.toLowerCase().includes(o.toLowerCase())||s.email.toLowerCase().includes(o.toLowerCase())||s.companyName&&s.companyName.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"users-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(F,{className:"inline-icon"})," Users Management"]}),e.jsx("p",{children:"Manage system users"})]}),e.jsx("div",{className:"header-actions",children:e.jsxs("button",{className:"btn-primary",onClick:()=>{n({name:"",email:"",password:"",role:"viewer",companyId:""}),d(!1),m(null),c(!0)},children:[e.jsx(D,{size:16})," Add User"]})})]}),e.jsx("div",{className:"users-search",children:e.jsxs("div",{className:"search-box",children:[e.jsx($,{className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:o,onChange:s=>U(s.target.value)})]})}),e.jsx("div",{className:"users-list",children:N?e.jsx("div",{className:"loading-state",children:"Loading..."}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[j.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"user-name",children:s.name})}),e.jsx("td",{children:s.email}),e.jsx("td",{children:e.jsx("span",{className:`role-badge ${s.role}`,children:s.role})}),e.jsx("td",{children:s.companyName||"-"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-icon",onClick:()=>C(s),title:"Edit User",children:e.jsx(A,{size:16})}),e.jsx("button",{className:"btn-icon danger",onClick:()=>S(s._id),title:"Delete User",children:e.jsx(R,{size:16})})]})})]},s._id)),j.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"No users found"})})]})]})}),w&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:l?"Edit User":"Add New User"}),e.jsx("button",{className:"modal-close",onClick:u,children:e.jsx(q,{})})]}),e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Full Name"}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:s=>n({...r,name:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",required:!0,value:r.email,onChange:s=>n({...r,email:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Password ",l&&"(Leave blank to keep current)"]}),e.jsx("input",{type:"password",required:!l,value:r.password,onChange:s=>n({...r,password:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{value:r.role,onChange:s=>n({...r,role:s.target.value}),children:[e.jsx("option",{value:"viewer",children:"Viewer"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Company"}),e.jsxs("select",{required:!0,value:r.companyId,onChange:s=>n({...r,companyId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Company..."}),x.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:l?"Update User":"Create User"})]})]})]})})]})};export{K as default};
