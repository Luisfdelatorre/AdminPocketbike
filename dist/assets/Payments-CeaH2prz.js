import{r as i,t as F,j as e}from"./main-DVAXFARq.js";import{u as T}from"./useTranslation-LM3aqFs0.js";import{D as M}from"./dollar-sign-B5DZ-WZI.js";import{C as U}from"./check-Ddl6_53K.js";import{C as V}from"./clock-D_nI2vjn.js";import{C as f}from"./credit-card-CRlv_u6l.js";import{S as z,X as B}from"./x-BNAztCrf.js";import{c as b}from"./createLucideIcon-Cp5FBxft.js";import"./modulepreload-polyfill-B5Qt9EMX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],_=b("chevron-left",G);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Q=b("chevron-right",q),ae=()=>{const{t:a}=T(),[l,C]=i.useState([]),[P,p]=i.useState(!0),[r,E]=i.useState("all"),[u,I]=i.useState("date"),[o,x]=i.useState(""),[n,m]=i.useState({page:1,limit:20,total:0,totalPages:0,hasNext:!1,hasPrev:!1});i.useEffect(()=>{j()},[n.page,r]);const j=async()=>{p(!0);try{const t={page:n.page,limit:n.limit};if(r!=="all"){const c={completed:"APPROVED",pending:"PENDING",failed:"DECLINED"};c[r]&&(t.status=c[r])}const s=await F(t);s.success?(C(s.payments||[]),m(c=>({...c,...s.pagination}))):console.error("Failed to load payments:",s.error)}catch(t){console.error("Error loading payments:",t)}finally{p(!1)}},D=t=>t==null?"$0 COP":`$${t.toLocaleString()} COP`,k=t=>{navigator.clipboard.writeText(t)},S=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=t=>{if(!t)return"N/A";const s=t.split("-");if(s.length>=4){const c=s[0],h=s[1],O=s[2],N=s[3],A=new Date(`${h}-${O}-${N}T12:00:00`).toLocaleDateString("en-US",{month:"short"});return`${c} ${A} ${parseInt(N)}`}return t},y=t=>{switch(t.toUpperCase()){case"APPROVED":return"#3b64c6";case"COMPLETED":case"FREE":return"#00C292";case"DECLINED":case"FAILED":case"ERROR":return"#EF4444";case"PENDING":case"VERIFYING":return"#FB9678";default:return"#6B7280"}},g=[...l].filter(t=>{if(!o)return!0;const s=o.toLowerCase(),c=t.deviceId&&t.deviceId.toLowerCase().includes(s),h=(t.invoiceId||t.unpaidInvoiceId||t.paymentReference||"").toLowerCase().includes(s);return c||h}).sort((t,s)=>{switch(u){case"date":return new Date(s.createdAt)-new Date(t.createdAt);case"amount":return s.amount-t.amount;case"device":return t.deviceId.localeCompare(s.deviceId);default:return 0}}),$=l.reduce((t,s)=>{const c=s.status.toUpperCase();return c==="APPROVED"||c==="COMPLETED"?t+s.amount:t},0),R=l.filter(t=>{const s=t.status.toUpperCase();return s==="APPROVED"||s==="COMPLETED"}).length,w=l.filter(t=>{const s=t.status.toUpperCase();return s==="PENDING"||s==="VERIFYING"}).length,v=t=>{m(s=>({...s,page:t}))},d=t=>{E(t),m(s=>({...s,page:1}))};return e.jsxs("div",{className:"payments-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsxs("h1",{children:["ðŸ’³ ",a("payments.title")]}),e.jsx("p",{children:a("payments.subtitle")})]}),e.jsxs("button",{className:"btn-primary",onClick:j,children:["ðŸ”„ ",a("payments.refresh")]})]}),e.jsxs("div",{className:"payment-stats",children:[e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#03C9D7"},children:e.jsx(M,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:a("payments.stats.revenue")}),e.jsx("div",{className:"stat-number",children:$})]})]}),e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#00C292"},children:e.jsx(U,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:a("payments.stats.completed")}),e.jsx("div",{className:"stat-number",children:R})]})]}),e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#FB9678"},children:e.jsx(V,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:a("payments.stats.pending")}),e.jsx("div",{className:"stat-number",children:w})]})]}),e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#7460EE"},children:e.jsx(f,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:a("payments.stats.total")}),e.jsx("div",{className:"stat-number",children:n.total})]})]})]}),e.jsxs("div",{className:"payment-controls",children:[e.jsxs("div",{className:"payment-filters",children:[e.jsx("button",{className:`filter-btn ${r==="all"?"active":""}`,onClick:()=>d("all"),children:a("payments.filters.all")}),e.jsx("button",{className:`filter-btn ${r==="completed"?"active":""}`,onClick:()=>d("completed"),children:a("payments.filters.completed")}),e.jsx("button",{className:`filter-btn ${r==="pending"?"active":""}`,onClick:()=>d("pending"),children:a("payments.filters.pending")}),e.jsx("button",{className:`filter-btn ${r==="failed"?"active":""}`,onClick:()=>d("failed"),children:a("payments.filters.failed")}),e.jsxs("div",{className:"search-box",children:[e.jsx(z,{className:"search-icon"}),e.jsx("input",{type:"text",placeholder:a("invoices.searchPlaceholder"),value:o,onChange:t=>x(t.target.value)}),o&&e.jsx("button",{className:"clear-search",onClick:()=>x(""),children:e.jsx(B,{})})]})]}),e.jsxs("select",{className:"sort-select",value:u,onChange:t=>I(t.target.value),children:[e.jsx("option",{value:"date",children:a("payments.sort.date")}),e.jsx("option",{value:"amount",children:a("payments.sort.amount")}),e.jsx("option",{value:"device",children:a("payments.sort.device")})]})]}),e.jsx("div",{className:"payments-table-container",children:P?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:a("payments.loading")})]}):g.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(f,{size:48}),e.jsx("h3",{children:a("payments.empty.title")}),e.jsx("p",{children:a("payments.empty.subtitle")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"payments-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:a("payments.table.id")}),e.jsx("th",{children:a("payments.table.device")}),e.jsx("th",{children:a("payments.table.amount")}),e.jsx("th",{children:a("payments.table.status")}),e.jsx("th",{children:a("payments.table.reference")}),e.jsx("th",{children:a("payments.table.date")})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"payment-id",title:"Click to copy full ID",onClick:()=>k(t.paymentId),style:{cursor:"pointer"},children:e.jsxs("code",{children:["...",t.paymentId.split("-").pop()]})}),e.jsx("td",{children:e.jsx("strong",{children:t.deviceId})}),e.jsx("td",{className:"amount",children:D(t.amount)}),e.jsx("td",{children:e.jsx("span",{className:"status-badge",style:{background:`${y(t.status)}20`,color:y(t.status)},children:t.status})}),e.jsx("td",{className:"payment-method",children:L(t.invoiceId||t.unpaidInvoiceId||t.paymentReference)}),e.jsx("td",{className:"date",children:S(t.createdAt)})]},t.paymentId))})]}),n.totalPages>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("button",{className:"pagination-btn",onClick:()=>v(n.page-1),disabled:!n.hasPrev,children:[e.jsx(_,{})," ",a("payments.pagination.previous")]}),e.jsx("span",{className:"pagination-info",children:a("payments.pagination.pageInfo",{page:n.page,totalPages:n.totalPages,total:n.total})}),e.jsxs("button",{className:"pagination-btn",onClick:()=>v(n.page+1),disabled:!n.hasNext,children:[a("payments.pagination.next")," ",e.jsx(Q,{})]})]})]})})]})};export{ae as default};
