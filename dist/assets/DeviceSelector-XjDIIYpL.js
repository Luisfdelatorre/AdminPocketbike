import{r as j,j as r,R as M,a as Ne,u as be,c as Ce,d as Ee,s as we,e as je,f as Me,h as Se,i as Ae,k as Re}from"./main-CESdpagL.js";import{s as k}from"./toast-DASUAV0i.js";import{u as K}from"./useTranslation-DcNv4gPV.js";import{c as _}from"./createLucideIcon-BSP4zInn.js";import{R as X,M as ke}from"./MotorIcon-Cw4aOK89.js";import{P as ie}from"./plus-CQDH23Fc.js";import{U as Pe}from"./users-Dq-dkqBF.js";import{S as Ie,X as Le}from"./x-BqA1gSp3.js";import{S as De}from"./square-pen-BjT_xe_F.js";import"./modulepreload-polyfill-B5Qt9EMX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M10 10v4",key:"1mb2ec"}],["path",{d:"M14 10v4",key:"1nt88p"}],["path",{d:"M22 14v-4",key:"14q9d5"}],["path",{d:"M6 10v4",key:"1n77qd"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],Fe=_("battery-full",Oe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M22 14v-4",key:"14q9d5"}],["path",{d:"M6 14v-4",key:"14a6bd"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],ze=_("battery-low",_e);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M10 14v-4",key:"suye4c"}],["path",{d:"M22 14v-4",key:"14q9d5"}],["path",{d:"M6 14v-4",key:"14a6bd"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],Te=_("battery-medium",Be);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],$e=_("circle-check-big",Ue);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],He=_("circle",Qe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ge=_("copy",qe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Ve=_("power",Ye);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],We=_("share-2",Xe),Ke=({isOpen:c,onClose:l,onSubmit:o,formData:d,setFormData:h,isEditing:m})=>{const{t:b}=K();return j.useEffect(()=>(c&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="unset"}),[c]),c?r.jsx("div",{className:"modal-overlay",onClick:l,children:r.jsxs("div",{className:"modal-content",onClick:x=>x.stopPropagation(),onMouseDown:x=>x.stopPropagation(),children:[r.jsx("h2",{children:b(m?"devices.form.editTitle":"devices.form.addTitle")}),r.jsxs("form",{onSubmit:o,children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:b("devices.form.deviceId")}),r.jsx("input",{type:"text",value:d._id,onChange:x=>h({...d,_id:x.target.value}),disabled:m,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:b("devices.form.name")}),r.jsx("input",{type:"text",value:d.deviceName,onChange:x=>h({...d,deviceName:x.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:b("devices.form.nequi")}),r.jsx("input",{type:"text",value:d.nequiNumber,onChange:x=>h({...d,nequiNumber:x.target.value})})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:b("devices.form.sim")}),r.jsx("input",{type:"text",value:d.simCardNumber,onChange:x=>h({...d,simCardNumber:x.target.value})})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:b("devices.form.notes")}),r.jsx("textarea",{value:d.notes,onChange:x=>h({...d,notes:x.target.value}),rows:"3"})]}),r.jsx("div",{className:"form-group checkbox-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:d.isActive,onChange:x=>h({...d,isActive:x.target.checked})}),b("devices.form.active")]})}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:l,children:b("common.cancel")}),r.jsx("button",{type:"submit",className:"btn-primary",children:b(m?"common.update":"common.create")})]})]})]})}):null};var Ze=Object.defineProperty,W=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,oe=(c,l,o)=>l in c?Ze(c,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[l]=o,se=(c,l)=>{for(var o in l||(l={}))ae.call(l,o)&&oe(c,o,l[o]);if(W)for(var o of W(l))le.call(l,o)&&oe(c,o,l[o]);return c},re=(c,l)=>{var o={};for(var d in c)ae.call(c,d)&&l.indexOf(d)<0&&(o[d]=c[d]);if(c!=null&&W)for(var d of W(c))l.indexOf(d)<0&&le.call(c,d)&&(o[d]=c[d]);return o};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var B;(c=>{const l=class N{constructor(e,s,t,n){if(this.version=e,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],e<N.MIN_VERSION||e>N.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=e*4+17;let i=[];for(let u=0;u<this.size;u++)i.push(!1);for(let u=0;u<this.size;u++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();const f=this.addEccAndInterleave(t);if(this.drawCodewords(f),n==-1){let u=1e9;for(let p=0;p<8;p++){this.applyMask(p),this.drawFormatBits(p);const g=this.getPenaltyScore();g<u&&(n=p,u=g),this.applyMask(p)}}h(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}static encodeText(e,s){const t=c.QrSegment.makeSegments(e);return N.encodeSegments(t,s)}static encodeBinary(e,s){const t=c.QrSegment.makeBytes(e);return N.encodeSegments([t],s)}static encodeSegments(e,s,t=1,n=40,i=-1,f=!0){if(!(N.MIN_VERSION<=t&&t<=n&&n<=N.MAX_VERSION)||i<-1||i>7)throw new RangeError("Invalid value");let u,p;for(u=t;;u++){const v=N.getNumDataCodewords(u,s)*8,C=b.getTotalBits(e,u);if(C<=v){p=C;break}if(u>=n)throw new RangeError("Data too long")}for(const v of[N.Ecc.MEDIUM,N.Ecc.QUARTILE,N.Ecc.HIGH])f&&p<=N.getNumDataCodewords(u,v)*8&&(s=v);let g=[];for(const v of e){o(v.mode.modeBits,4,g),o(v.numChars,v.mode.numCharCountBits(u),g);for(const C of v.getData())g.push(C)}h(g.length==p);const S=N.getNumDataCodewords(u,s)*8;h(g.length<=S),o(0,Math.min(4,S-g.length),g),o(0,(8-g.length%8)%8,g),h(g.length%8==0);for(let v=236;g.length<S;v^=253)o(v,8,g);let w=[];for(;w.length*8<g.length;)w.push(0);return g.forEach((v,C)=>w[C>>>3]|=v<<7-(C&7)),new N(u,s,w,i)}getModule(e,s){return 0<=e&&e<this.size&&0<=s&&s<this.size&&this.modules[s][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),s=e.length;for(let t=0;t<s;t++)for(let n=0;n<s;n++)t==0&&n==0||t==0&&n==s-1||t==s-1&&n==0||this.drawAlignmentPattern(e[t],e[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const s=this.errorCorrectionLevel.formatBits<<3|e;let t=s;for(let i=0;i<10;i++)t=t<<1^(t>>>9)*1335;const n=(s<<10|t)^21522;h(n>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,d(n,i));this.setFunctionModule(8,7,d(n,6)),this.setFunctionModule(8,8,d(n,7)),this.setFunctionModule(7,8,d(n,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,d(n,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,d(n,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,d(n,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;const s=this.version<<12|e;h(s>>>18==0);for(let t=0;t<18;t++){const n=d(s,t),i=this.size-11+t%3,f=Math.floor(t/3);this.setFunctionModule(i,f,n),this.setFunctionModule(f,i,n)}}drawFinderPattern(e,s){for(let t=-4;t<=4;t++)for(let n=-4;n<=4;n++){const i=Math.max(Math.abs(n),Math.abs(t)),f=e+n,u=s+t;0<=f&&f<this.size&&0<=u&&u<this.size&&this.setFunctionModule(f,u,i!=2&&i!=4)}}drawAlignmentPattern(e,s){for(let t=-2;t<=2;t++)for(let n=-2;n<=2;n++)this.setFunctionModule(e+n,s+t,Math.max(Math.abs(n),Math.abs(t))!=1)}setFunctionModule(e,s,t){this.modules[s][e]=t,this.isFunction[s][e]=!0}addEccAndInterleave(e){const s=this.version,t=this.errorCorrectionLevel;if(e.length!=N.getNumDataCodewords(s,t))throw new RangeError("Invalid argument");const n=N.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][s],i=N.ECC_CODEWORDS_PER_BLOCK[t.ordinal][s],f=Math.floor(N.getNumRawDataModules(s)/8),u=n-f%n,p=Math.floor(f/n);let g=[];const S=N.reedSolomonComputeDivisor(i);for(let v=0,C=0;v<n;v++){let P=e.slice(C,C+p-i+(v<u?0:1));C+=P.length;const D=N.reedSolomonComputeRemainder(P,S);v<u&&P.push(0),g.push(P.concat(D))}let w=[];for(let v=0;v<g[0].length;v++)g.forEach((C,P)=>{(v!=p-i||P>=u)&&w.push(C[v])});return h(w.length==f),w}drawCodewords(e){if(e.length!=Math.floor(N.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let s=0;for(let t=this.size-1;t>=1;t-=2){t==6&&(t=5);for(let n=0;n<this.size;n++)for(let i=0;i<2;i++){const f=t-i,p=(t+1&2)==0?this.size-1-n:n;!this.isFunction[p][f]&&s<e.length*8&&(this.modules[p][f]=d(e[s>>>3],7-(s&7)),s++)}}h(s==e.length*8)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let s=0;s<this.size;s++)for(let t=0;t<this.size;t++){let n;switch(e){case 0:n=(t+s)%2==0;break;case 1:n=s%2==0;break;case 2:n=t%3==0;break;case 3:n=(t+s)%3==0;break;case 4:n=(Math.floor(t/3)+Math.floor(s/2))%2==0;break;case 5:n=t*s%2+t*s%3==0;break;case 6:n=(t*s%2+t*s%3)%2==0;break;case 7:n=((t+s)%2+t*s%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[s][t]&&n&&(this.modules[s][t]=!this.modules[s][t])}}getPenaltyScore(){let e=0;for(let i=0;i<this.size;i++){let f=!1,u=0,p=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[i][g]==f?(u++,u==5?e+=N.PENALTY_N1:u>5&&e++):(this.finderPenaltyAddHistory(u,p),f||(e+=this.finderPenaltyCountPatterns(p)*N.PENALTY_N3),f=this.modules[i][g],u=1);e+=this.finderPenaltyTerminateAndCount(f,u,p)*N.PENALTY_N3}for(let i=0;i<this.size;i++){let f=!1,u=0,p=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[g][i]==f?(u++,u==5?e+=N.PENALTY_N1:u>5&&e++):(this.finderPenaltyAddHistory(u,p),f||(e+=this.finderPenaltyCountPatterns(p)*N.PENALTY_N3),f=this.modules[g][i],u=1);e+=this.finderPenaltyTerminateAndCount(f,u,p)*N.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let f=0;f<this.size-1;f++){const u=this.modules[i][f];u==this.modules[i][f+1]&&u==this.modules[i+1][f]&&u==this.modules[i+1][f+1]&&(e+=N.PENALTY_N2)}let s=0;for(const i of this.modules)s=i.reduce((f,u)=>f+(u?1:0),s);const t=this.size*this.size,n=Math.ceil(Math.abs(s*20-t*10)/t)-1;return h(0<=n&&n<=9),e+=n*N.PENALTY_N4,h(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(this.version==1)return[];{const e=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(e*2-2))*2;let t=[6];for(let n=this.size-7;t.length<e;n-=s)t.splice(1,0,n);return t}}static getNumRawDataModules(e){if(e<N.MIN_VERSION||e>N.MAX_VERSION)throw new RangeError("Version number out of range");let s=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;s-=(25*t-10)*t-55,e>=7&&(s-=36)}return h(208<=s&&s<=29648),s}static getNumDataCodewords(e,s){return Math.floor(N.getNumRawDataModules(e)/8)-N.ECC_CODEWORDS_PER_BLOCK[s.ordinal][e]*N.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let s=[];for(let n=0;n<e-1;n++)s.push(0);s.push(1);let t=1;for(let n=0;n<e;n++){for(let i=0;i<s.length;i++)s[i]=N.reedSolomonMultiply(s[i],t),i+1<s.length&&(s[i]^=s[i+1]);t=N.reedSolomonMultiply(t,2)}return s}static reedSolomonComputeRemainder(e,s){let t=s.map(n=>0);for(const n of e){const i=n^t.shift();t.push(0),s.forEach((f,u)=>t[u]^=N.reedSolomonMultiply(f,i))}return t}static reedSolomonMultiply(e,s){if(e>>>8||s>>>8)throw new RangeError("Byte out of range");let t=0;for(let n=7;n>=0;n--)t=t<<1^(t>>>7)*285,t^=(s>>>n&1)*e;return h(t>>>8==0),t}finderPenaltyCountPatterns(e){const s=e[1];h(s<=this.size*3);const t=s>0&&e[2]==s&&e[3]==s*3&&e[4]==s&&e[5]==s;return(t&&e[0]>=s*4&&e[6]>=s?1:0)+(t&&e[6]>=s*4&&e[0]>=s?1:0)}finderPenaltyTerminateAndCount(e,s,t){return e&&(this.finderPenaltyAddHistory(s,t),s=0),s+=this.size,this.finderPenaltyAddHistory(s,t),this.finderPenaltyCountPatterns(t)}finderPenaltyAddHistory(e,s){s[0]==0&&(e+=this.size),s.pop(),s.unshift(e)}};l.MIN_VERSION=1,l.MAX_VERSION=40,l.PENALTY_N1=3,l.PENALTY_N2=3,l.PENALTY_N3=40,l.PENALTY_N4=10,l.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],l.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],c.QrCode=l;function o(x,e,s){if(e<0||e>31||x>>>e)throw new RangeError("Value out of range");for(let t=e-1;t>=0;t--)s.push(x>>>t&1)}function d(x,e){return(x>>>e&1)!=0}function h(x){if(!x)throw new Error("Assertion error")}const m=class E{constructor(e,s,t){if(this.mode=e,this.numChars=s,this.bitData=t,s<0)throw new RangeError("Invalid argument");this.bitData=t.slice()}static makeBytes(e){let s=[];for(const t of e)o(t,8,s);return new E(E.Mode.BYTE,e.length,s)}static makeNumeric(e){if(!E.isNumeric(e))throw new RangeError("String contains non-numeric characters");let s=[];for(let t=0;t<e.length;){const n=Math.min(e.length-t,3);o(parseInt(e.substring(t,t+n),10),n*3+1,s),t+=n}return new E(E.Mode.NUMERIC,e.length,s)}static makeAlphanumeric(e){if(!E.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let s=[],t;for(t=0;t+2<=e.length;t+=2){let n=E.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t))*45;n+=E.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t+1)),o(n,11,s)}return t<e.length&&o(E.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t)),6,s),new E(E.Mode.ALPHANUMERIC,e.length,s)}static makeSegments(e){return e==""?[]:E.isNumeric(e)?[E.makeNumeric(e)]:E.isAlphanumeric(e)?[E.makeAlphanumeric(e)]:[E.makeBytes(E.toUtf8ByteArray(e))]}static makeEci(e){let s=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)o(e,8,s);else if(e<16384)o(2,2,s),o(e,14,s);else if(e<1e6)o(6,3,s),o(e,21,s);else throw new RangeError("ECI assignment value out of range");return new E(E.Mode.ECI,0,s)}static isNumeric(e){return E.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return E.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,s){let t=0;for(const n of e){const i=n.mode.numCharCountBits(s);if(n.numChars>=1<<i)return 1/0;t+=4+i+n.bitData.length}return t}static toUtf8ByteArray(e){e=encodeURI(e);let s=[];for(let t=0;t<e.length;t++)e.charAt(t)!="%"?s.push(e.charCodeAt(t)):(s.push(parseInt(e.substring(t+1,t+3),16)),t+=2);return s}};m.NUMERIC_REGEX=/^[0-9]*$/,m.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,m.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let b=m;c.QrSegment=m})(B||(B={}));(c=>{(l=>{const o=class{constructor(h,m){this.ordinal=h,this.formatBits=m}};o.LOW=new o(0,1),o.MEDIUM=new o(1,0),o.QUARTILE=new o(2,3),o.HIGH=new o(3,2),l.Ecc=o})(c.QrCode||(c.QrCode={}))})(B||(B={}));(c=>{(l=>{const o=class{constructor(h,m){this.modeBits=h,this.numBitsCharCount=m}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};o.NUMERIC=new o(1,[10,12,14]),o.ALPHANUMERIC=new o(2,[9,11,13]),o.BYTE=new o(4,[8,16,16]),o.KANJI=new o(8,[8,10,12]),o.ECI=new o(7,[0,0,0]),l.Mode=o})(c.QrSegment||(c.QrSegment={}))})(B||(B={}));var $=B;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Je={L:$.QrCode.Ecc.LOW,M:$.QrCode.Ecc.MEDIUM,Q:$.QrCode.Ecc.QUARTILE,H:$.QrCode.Ecc.HIGH},ce=128,de="L",ue="#FFFFFF",he="#000000",me=!1,fe=1,et=4,tt=0,st=.1;function ge(c,l=0){const o=[];return c.forEach(function(d,h){let m=null;d.forEach(function(b,x){if(!b&&m!==null){o.push(`M${m+l} ${h+l}h${x-m}v1H${m+l}z`),m=null;return}if(x===d.length-1){if(!b)return;m===null?o.push(`M${x+l},${h+l} h1v1H${x+l}z`):o.push(`M${m+l},${h+l} h${x+1-m}v1H${m+l}z`);return}b&&m===null&&(m=x)})}),o.join("")}function xe(c,l){return c.slice().map((o,d)=>d<l.y||d>=l.y+l.h?o:o.map((h,m)=>m<l.x||m>=l.x+l.w?h:!1))}function rt(c,l,o,d){if(d==null)return null;const h=c.length+o*2,m=Math.floor(l*st),b=h/l,x=(d.width||m)*b,e=(d.height||m)*b,s=d.x==null?c.length/2-x/2:d.x*b,t=d.y==null?c.length/2-e/2:d.y*b,n=d.opacity==null?1:d.opacity;let i=null;if(d.excavate){let u=Math.floor(s),p=Math.floor(t),g=Math.ceil(x+s-u),S=Math.ceil(e+t-p);i={x:u,y:p,w:g,h:S}}const f=d.crossOrigin;return{x:s,y:t,h:e,w:x,excavation:i,opacity:n,crossOrigin:f}}function nt(c,l){return l!=null?Math.max(Math.floor(l),0):c?et:tt}function ve({value:c,level:l,minVersion:o,includeMargin:d,marginSize:h,imageSettings:m,size:b,boostLevel:x}){let e=M.useMemo(()=>{const u=(Array.isArray(c)?c:[c]).reduce((p,g)=>(p.push(...$.QrSegment.makeSegments(g)),p),[]);return $.QrCode.encodeSegments(u,Je[l],o,void 0,void 0,x)},[c,l,o,x]);const{cells:s,margin:t,numCells:n,calculatedImageSettings:i}=M.useMemo(()=>{let f=e.getModules();const u=nt(d,h),p=f.length+u*2,g=rt(f,b,u,m);return{cells:f,margin:u,numCells:p,calculatedImageSettings:g}},[e,b,m,d,h]);return{qrcode:e,margin:t,cells:s,numCells:n,calculatedImageSettings:i}}var it=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),ot=M.forwardRef(function(l,o){const d=l,{value:h,size:m=ce,level:b=de,bgColor:x=ue,fgColor:e=he,includeMargin:s=me,minVersion:t=fe,boostLevel:n,marginSize:i,imageSettings:f}=d,p=re(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:g}=p,S=re(p,["style"]),w=f==null?void 0:f.src,v=M.useRef(null),C=M.useRef(null),P=M.useCallback(L=>{v.current=L,typeof o=="function"?o(L):o&&(o.current=L)},[o]),[D,T]=M.useState(!1),{margin:F,cells:Y,numCells:U,calculatedImageSettings:A}=ve({value:h,level:b,minVersion:t,boostLevel:n,includeMargin:s,marginSize:i,imageSettings:f,size:m});M.useEffect(()=>{if(v.current!=null){const L=v.current,I=L.getContext("2d");if(!I)return;let V=Y;const z=C.current,O=A!=null&&z!==null&&z.complete&&z.naturalHeight!==0&&z.naturalWidth!==0;O&&A.excavation!=null&&(V=xe(Y,A.excavation));const q=window.devicePixelRatio||1;L.height=L.width=m*q;const G=m/U*q;I.scale(G,G),I.fillStyle=x,I.fillRect(0,0,U,U),I.fillStyle=e,it?I.fill(new Path2D(ge(V,F))):Y.forEach(function(Z,J){Z.forEach(function(ee,te){ee&&I.fillRect(te+F,J+F,1,1)})}),A&&(I.globalAlpha=A.opacity),O&&I.drawImage(z,A.x+F,A.y+F,A.w,A.h)}}),M.useEffect(()=>{T(!1)},[w]);const Q=se({height:m,width:m},g);let H=null;return w!=null&&(H=M.createElement("img",{src:w,key:w,style:{display:"none"},onLoad:()=>{T(!0)},ref:C,crossOrigin:A==null?void 0:A.crossOrigin})),M.createElement(M.Fragment,null,M.createElement("canvas",se({style:Q,height:m,width:m,ref:P,role:"img"},S)),H)});ot.displayName="QRCodeCanvas";var pe=M.forwardRef(function(l,o){const d=l,{value:h,size:m=ce,level:b=de,bgColor:x=ue,fgColor:e=he,includeMargin:s=me,minVersion:t=fe,boostLevel:n,title:i,marginSize:f,imageSettings:u}=d,p=re(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:g,cells:S,numCells:w,calculatedImageSettings:v}=ve({value:h,level:b,minVersion:t,boostLevel:n,includeMargin:s,marginSize:f,imageSettings:u,size:m});let C=S,P=null;u!=null&&v!=null&&(v.excavation!=null&&(C=xe(S,v.excavation)),P=M.createElement("image",{href:u.src,height:v.h,width:v.w,x:v.x+g,y:v.y+g,preserveAspectRatio:"none",opacity:v.opacity,crossOrigin:v.crossOrigin}));const D=ge(C,g);return M.createElement("svg",se({height:m,width:m,viewBox:`0 0 ${w} ${w}`,ref:o,role:"img"},p),!!i&&M.createElement("title",null,i),M.createElement("path",{fill:x,d:`M0,0 h${w}v${w}H0z`,shapeRendering:"crispEdges"}),M.createElement("path",{fill:e,d:D,shapeRendering:"crispEdges"}),P)});pe.displayName="QRCodeSVG";const at=({isOpen:c,onClose:l,shareUrl:o,onCopy:d})=>{const{t:h}=K();return c?r.jsx("div",{className:"modal-overlay",onClick:l,children:r.jsxs("div",{className:"modal-content",onClick:m=>m.stopPropagation(),children:[r.jsx("h2",{children:h("devices.share.title")}),r.jsx("p",{children:h("devices.share.subtitle")}),r.jsx("div",{className:"qr-code-display",style:{display:"flex",justifyContent:"center",margin:"1.5rem 0",padding:"1rem",background:"white",borderRadius:"0.5rem"},children:r.jsx(pe,{value:o,size:200})}),r.jsxs("div",{className:"share-link-box",style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",background:"#F3F4F6",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #E5E7EB"},children:[r.jsx("input",{type:"text",value:o,readOnly:!0,style:{flex:1,background:"transparent",border:"none",fontSize:"0.875rem",color:"#4B5563",outline:"none"}}),r.jsxs("button",{onClick:d,style:{background:"none",border:"none",cursor:"pointer",color:"#03C9D7",display:"flex",alignItems:"center",gap:"0.25rem"},children:[r.jsx(Ge,{})," ",h("devices.share.copy")]})]}),r.jsxs("div",{className:"pin-warning",style:{background:"#FEF3C7",color:"#92400E",padding:"0.75rem",borderRadius:"0.5rem",fontSize:"0.875rem",marginBottom:"1.5rem"},children:[r.jsx("strong",{children:h("devices.share.note")})," ",h("devices.share.noteText")]}),r.jsx("button",{className:"btn-primary full-width",onClick:l,children:h("common.done")})]})}):null},lt=({isOpen:c,onClose:l,onConfirm:o,deviceId:d})=>{const{t:h}=K();return c?r.jsx("div",{className:"modal-overlay",onClick:l,children:r.jsxs("div",{className:"modal-content",onClick:m=>m.stopPropagation(),style:{maxWidth:"400px"},children:[r.jsx("h2",{children:h("common.confirmDelete")}),r.jsxs("p",{children:[h("devices.deleteConfirmText")," ",r.jsx("strong",{children:d}),"?"]}),r.jsx("p",{style:{color:"#6B7280",fontSize:"0.875rem",marginTop:"0.5rem"},children:h("devices.deleteNote")}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:l,children:h("common.cancel")}),r.jsx("button",{className:"btn-primary",style:{background:"#EF4444"},onClick:o,children:h("common.delete")})]})]})}):null},ct=({children:c})=>{const[l,o]=j.useState(null);return j.useEffect(()=>{o(document.getElementById("mobile-header-actions"))},[]),l?je.createPortal(c,l):null},Ct=()=>{Ne();const{t:c}=K(),{user:l}=be(),[o,d]=j.useState([]),[h,m]=j.useState(!0),[b,x]=j.useState(!1),[e,s]=j.useState(null),[t,n]=j.useState(!1),[i,f]=j.useState(""),[u,p]=j.useState(""),[g,S]=j.useState(""),[w,v]=j.useState(!1),[C,P]=j.useState(null),[D,T]=j.useState("all"),[F,Y]=j.useState("technical"),[U,A]=j.useState(null),[Q,H]=j.useState({}),[L,I]=j.useState({_id:"",deviceName:"",nequiNumber:"",simCardNumber:"",isActive:!0,notes:""});j.useEffect(()=>{O()},[F]),j.useEffect(()=>{const a=y=>{U&&!y.target.closest(".action-menu-container")&&A(null)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[U]);const V=a=>{const y=`${window.location.origin}/p/${a.name}`;f(y),p(a.deviceId),n(!0)},z=async()=>{try{await navigator.clipboard.writeText(i)}catch(a){console.error("Failed to copy text: ",a);const y=document.createElement("textarea");y.value=i,document.body.appendChild(y),y.focus(),y.select(),y.setSelectionRange(0,99999);try{document.execCommand("copy")}catch(R){console.error("Unable to copy",R),k("Failed to copy link manually.","error")}document.body.removeChild(y)}},O=async()=>{m(!0);try{let a;if(F!=="financial"){const y=await Ce();console.log(y),a={success:!0,devices:y}}else a=await Ee();a.success&&d(a.devices||[])}catch(a){console.error("Error fetching devices:",a),k("Failed to load devices","error")}finally{m(!1)}},q=async()=>{console.log("Sync button clicked"),console.log("Starting sync..."),m(!0);try{const a=await we();console.log("Sync result:",a),a.success?(k(a.message,"success"),O()):k(a.error||"Sync failed","error")}catch(a){console.error("Error syncing devices:",a),k("Failed to sync devices: "+a.message,"error")}finally{m(!1)}},G=()=>{s(null),I({_id:"",deviceName:"",nequiNumber:"",simCardNumber:"",isActive:!0,notes:""}),x(!0)},Z=a=>{s(a),I({_id:a._id,deviceName:a.deviceName,nequiNumber:a.nequiNumber||"",simCardNumber:a.simCardNumber||"",isActive:a.isActive,notes:a.notes||""}),x(!0)},J=async a=>{a.preventDefault();try{const y=e?await Se(e._id,L):await Ae(L);y.success?(x(!1),O(),k(e?"Device updated successfully":"Device created successfully","success")):k(y.error||"Failed to save device","error")}catch(y){console.error("Error saving device:",y),k("Failed to save device","error")}},ee=async()=>{if(!C)return;const a=C._id;try{const y=await Re(a);y.success?(O(),v(!1),P(null),k("Device deactivated successfully","success")):k(y.error,"error")}catch(y){console.error("Error deleting device:",y),k(`Failed to delete device: ${y.message||"Unknown error"}`,"error")}},te=async a=>{const y=a.deviceId;H(R=>({...R,[y]:!0})),console.log("Engine control request:",y,a.cutOff);try{const R=await Me(y,a.cutOff);R.success?(k(R.message,"success"),O()):k(R.error||"Failed to control engine","error")}catch(R){console.error("Engine control error:",R),k(R.message||"Error controlling engine","error")}finally{H(R=>({...R,[y]:!1}))}},ne=o.filter(a=>{if(g){const y=g.toLowerCase(),R=a.name||a.deviceName||"",ye=a._id||"";if(!String(ye).includes(y)&&!R.toLowerCase().includes(y))return!1}return!(D==="active"&&!a.hasActiveContract||D==="available"&&(a.hasActiveContract||!a.isActive))});return h?r.jsx("div",{className:"devices-page",children:r.jsxs("div",{className:"loading-state",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:c("common.loading")})]})}):r.jsxs("div",{className:"devices-page",children:[r.jsxs("div",{className:"page-header",children:[r.jsx("div",{className:"desktop-only",children:r.jsx("h1",{children:c("devices.title")})}),l!=null&&l.isSuperAdmin?r.jsxs("button",{className:"btn-secondary desktop-only",onClick:q,disabled:h,style:{marginRight:"1rem"},children:[r.jsx(X,{className:h?"spin":""})," ",c("devices.sync")]}):r.jsxs("button",{className:"btn-secondary desktop-only",onClick:O,disabled:h,style:{marginRight:"1rem"},children:[r.jsx(X,{className:h?"spin":""})," ",c("payments.refresh")]}),r.jsxs("button",{className:"btn-primary desktop-only",onClick:G,children:[r.jsx(ie,{})," ",c("devices.addDevice")]}),r.jsxs(ct,{children:[r.jsx("button",{onClick:G,className:"btn-mobile-header-action",children:r.jsx(ie,{size:24})}),r.jsx("button",{onClick:l!=null&&l.isSuperAdmin?q:O,className:"btn-mobile-header-action",children:r.jsx(X,{size:20,className:h?"spin":""})})]})]}),r.jsxs("div",{className:"devices-stats desktop-only",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",style:{background:"#03C9D7"},children:r.jsx(Pe,{})}),r.jsxs("div",{className:"stat-info",children:[r.jsx("div",{className:"stat-label",children:c("devices.totalDevices")}),r.jsx("div",{className:"stat-number",children:o.length})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",style:{background:"#00C292"},children:r.jsx($e,{})}),r.jsxs("div",{className:"stat-info",children:[r.jsx("div",{className:"stat-label",children:c("devices.activeContracts")}),r.jsx("div",{className:"stat-number",children:o.filter(a=>a.hasActiveContract).length})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",style:{background:"#FB9678"},children:r.jsx(He,{})}),r.jsxs("div",{className:"stat-info",children:[r.jsx("div",{className:"stat-label",children:c("devices.available")}),r.jsx("div",{className:"stat-number",children:o.filter(a=>!a.hasActiveContract&&a.isActive).length})]})]})]}),r.jsxs("div",{className:"devices-filters",children:[r.jsx("button",{className:`filter-btn ${D==="all"?"active":""}`,onClick:()=>T("all"),children:c("devices.filterAll")}),r.jsx("button",{className:`filter-btn ${D==="active"?"active":""}`,onClick:()=>T("active"),children:c("devices.filterActive")}),r.jsx("button",{className:`filter-btn ${D==="available"?"active":""}`,onClick:()=>T("available"),children:c("devices.filterAvailable")}),r.jsxs("div",{className:"search-box",children:[r.jsx(Ie,{className:"search-icon"}),r.jsx("input",{type:"text",placeholder:c("devices.searchPlaceholder"),value:g,onChange:a=>S(a.target.value)}),g&&r.jsx("button",{className:"clear-search",onClick:()=>S(""),children:r.jsx(Le,{})})]})]}),r.jsxs("div",{className:"w-full bg-white rounded-2xl shadow-sm border border-gray-100",children:[r.jsxs("div",{className:"grid grid-cols-4 lg:grid-cols-7 gap-6 px-2 py-2 border-b border-gray-100",children:[r.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center",children:c("devices.table.contract")}),r.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center",children:"Pagado"}),r.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase hidden lg:flex items-center",children:"Deuda"}),r.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase hidden lg:flex items-center",children:"Estado"}),r.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase hidden lg:flex items-center",children:"Dias Libres"}),r.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center justify-center",children:"Motor"}),r.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center justify-center",children:c("devices.table.actions")})]}),r.jsx("div",{className:"divide-y divide-gray-50",children:ne.map(a=>r.jsxs("div",{className:"grid grid-cols-4 lg:grid-cols-7 gap-6 px-2 py-2 hover:bg-gray-50/50 transition-colors items-center text-sm",children:[r.jsx("div",{className:"font-semibold text-gray-900 flex items-center",children:r.jsxs("a",{href:`/p/${a.name}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 cursor-pointer hover:text-gray-600 flex flex-col",children:[r.jsx("span",{className:"text-gray-900 font-medium",children:a.name}),a.contractId&&r.jsx("span",{className:"text-[8px] text-gray-400",children:a.contractId})]})}),r.jsxs("div",{className:"text-emerald-600 flex items-center font-bold",children:["$",(a.monthPaid||0).toLocaleString()]}),r.jsxs("div",{className:`flex items-center font-bold ${a.monthDebt>0?"text-red-600":"text-gray-400"}`,children:["$",(a.monthDebt||0).toLocaleString()]}),r.jsx("div",{className:"text-gray-500 hidden lg:flex items-center",children:a.status?r.jsx("span",{className:"contract-active px-2 py-1 bg-emerald-50 text-emerald-600 rounded-md text-xs font-medium",children:a.status}):r.jsx("span",{className:"contract-none text-gray-300",children:"--"})}),r.jsx("div",{className:"text-blue-600 flex items-center font-bold pl-4",children:a.freeDays||0}),r.jsxs("div",{className:"flex items-center justify-center gap-4",children:[r.jsx("div",{className:`flex flex-col items-center justify-center ${a.cutOff===1?"text-red-500":a.cutOff===2?"text-yellow-500":a.ignition?"text-emerald-500":"text-gray-300"}`,children:r.jsx(ke,{})}),r.jsx("div",{className:`flex items-center gap-1 ${a.batteryLevel>70?"text-emerald-500":a.batteryLevel>30?"text-yellow-500":"text-red-500"}`,children:a.batteryLevel>70?r.jsx(Fe,{size:20}):a.batteryLevel>30?r.jsx(Te,{size:20}):r.jsx(ze,{size:20,className:"animate-pulse"})}),r.jsx("div",{className:"flex items-center",children:r.jsx("button",{onClick:y=>{y.stopPropagation(),te(a)},disabled:Q[a.deviceId],className:`engine-toggle-slider ${a.cutOff===1?"deactivated":"active"} ${Q[a.deviceId]?"pending":""}`,title:a.cutOff===1?"Activar Moto":"Desactivar Moto",children:r.jsx("div",{className:"slider-knob",children:Q[a.deviceId]?r.jsx(X,{size:12,className:"spin"}):r.jsx(Ve,{size:12})})})})]}),r.jsxs("div",{className:"flex items-center justify-center relative action-menu-container",children:[r.jsx("button",{className:" text-left  text-sm text-gray-700  flex items-center  transition-colors",onClick:y=>{y.stopPropagation(),V(a),A(null)},children:r.jsx(We,{size:16,className:"text-gray-500"})}),r.jsx("button",{className:" text-left px-4 py-2.5 text-sm text-gray-700  flex items-center  ",onClick:y=>{y.stopPropagation(),Z(a),A(null)},children:r.jsx(De,{size:16,className:"text-gray-500"})})]})]},a._id))})]}),ne.length===0&&r.jsx("div",{className:"empty-state",children:r.jsx("p",{children:c("devices.emptyState")})}),r.jsx(Ke,{isOpen:b,onClose:()=>x(!1),onSubmit:J,formData:L,setFormData:I,isEditing:!!e}),r.jsx(at,{isOpen:t,onClose:()=>n(!1),shareUrl:i,onCopy:z}),r.jsx(lt,{isOpen:w,onClose:()=>v(!1),onConfirm:ee,deviceId:C==null?void 0:C._id})]})};export{Ct as default};
