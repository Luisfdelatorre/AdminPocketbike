import{r as o,j as e,G as oe,H as ce}from"./main-C1Sfkfil.js";import{S as le}from"./settings-BlfKtAmE.js";import{D as $}from"./dollar-sign-DRxWpRMY.js";import{C as B}from"./clock-CTiQIlap.js";import{c as f}from"./createLucideIcon-_2uQCNRD.js";import"./modulepreload-polyfill-B5Qt9EMX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],M=f("database",re);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],R=f("image",de);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ge=f("pen",he);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],j=f("save",me);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ue=f("zoom-in",pe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ve=f("zoom-out",xe),be=()=>{const[a,z]=o.useState({dailyRate:35e3,contractDays:500,currency:"COP",timezone:"America/Bogota",displayName:"PocketBike",companyLogo:"/pocketbike_60x60.jpg",automaticCutOff:!1,cutOffStrategy:1,gpsService:"megarastreo",gpsConfig:{host:"",port:"",user:"",password:"",token:""},wompiConfig:{publicKey:"",privateKey:"",integritySecret:"",eventsSecret:""}}),[I,C]=o.useState(!1),[h,P]=o.useState({}),[g,L]=o.useState({}),[D,E]=o.useState(!1),[K,O]=o.useState(null),[m,x]=o.useState(1),[p,S]=o.useState({x:0,y:0}),[_,N]=o.useState(!1),[b,F]=o.useState({x:0,y:0}),v=o.useRef(null),w=o.useRef(null),r=(s,t)=>{z(n=>({...n,[s]:t})),C(!1)};o.useEffect(()=>{(async()=>{try{const t=await oe();t.success&&z(n=>({...n,...t.data,companyLogo:t.data.logo||n.companyLogo}))}catch(t){console.error("Error fetching settings:",t)}})()},[]),o.useEffect(()=>{D&&v.current&&w.current&&Y()},[D,K,m,p]);const Y=()=>{const s=v.current,t=s.getContext("2d"),n=w.current;if(!n||!n.complete)return;t.clearRect(0,0,s.width,s.height),t.save(),t.translate(s.width/2+p.x,s.height/2+p.y),t.drawImage(n,-n.width*m/2,-n.height*m/2,n.width*m,n.height*m),t.restore();const i=s.width/2,c=s.height/2,d=Math.min(s.width,s.height)*.8,l=d/2;t.fillStyle="rgba(0, 0, 0, 0.6)",t.fillRect(0,0,s.width,s.height),t.clearRect(i-l,c-l,d,d),t.save(),t.beginPath(),t.rect(i-l,c-l,d,d),t.clip(),t.translate(s.width/2+p.x,s.height/2+p.y),t.drawImage(n,-n.width*m/2,-n.height*m/2,n.width*m,n.height*m),t.restore(),t.strokeStyle="#3b82f6",t.lineWidth=3,t.strokeRect(i-l,c-l,d,d)},X=s=>{N(!0),F({x:s.clientX-p.x,y:s.clientY-p.y})},Z=s=>{_&&S({x:s.clientX-b.x,y:s.clientY-b.y})},U=()=>{N(!1)},H=s=>{const t=s.touches[0];N(!0),F({x:t.clientX-p.x,y:t.clientY-p.y})},G=s=>{if(!_)return;s.preventDefault();const t=s.touches[0];S({x:t.clientX-b.x,y:t.clientY-b.y})},V=()=>{N(!1)},W=async()=>{await y("all")},y=async s=>{P(t=>({...t,[s]:!0}));try{const t=localStorage.getItem("token")||localStorage.getItem("auth_token");let n={};s==="all"?n={...a,logo:a.companyLogo}:s==="branding"?n={displayName:a.displayName,logo:a.companyLogo}:s==="gps"?n={gpsService:a.gpsService,gpsConfig:a.gpsConfig}:s==="wompi"?n={wompiConfig:a.wompiConfig}:s==="cutoff"?n={automaticCutOff:a.automaticCutOff,cutOffStrategy:a.cutOffStrategy}:s==="general"&&(n={currency:a.currency,timezone:a.timezone,dailyRate:a.dailyRate,contractDays:a.contractDays});const i=await ce(n);i.success?(console.log(`${s} settings saved successfully`),L(c=>({...c,[s]:!0})),setTimeout(()=>{L(c=>({...c,[s]:!1}))},3e3),(s==="all"||s==="branding")&&(localStorage.setItem("companyLogo",a.companyLogo),localStorage.setItem("displayName",a.displayName)),s==="all"&&(C(!0),setTimeout(()=>C(!1),3e3))):alert(`Error saving ${s} settings: `+i.error)}catch(t){console.error(`Error saving ${s} settings:`,t),alert(`Error saving ${s} settings`)}finally{P(t=>({...t,[s]:!1}))}},J=s=>{const t=s.target.files[0];if(t){if(!t.type.startsWith("image/")){alert("Please upload an image file");return}if(t.size>2*1024*1024){alert("Image size should be less than 2MB");return}const n=new FileReader;n.onloadend=()=>{const i=new Image;i.onload=()=>{if(w.current=i,v.current){const c=v.current,d=c.width/i.width,l=c.height/i.height,k=Math.max(d,l)*.8;x(k),S({x:0,y:0})}O(n.result),E(!0)},i.src=n.result},n.readAsDataURL(t),s.target.value=""}},q=()=>{const s=v.current,t=w.current;if(!s||!t)return;const n=document.createElement("canvas");n.width=300,n.height=300;const i=n.getContext("2d"),c=s.width/2,d=s.height/2,l=Math.min(s.width,s.height)*.8,k=l/2,ae=c-k,ne=d-k;i.drawImage(s,ae+2,ne+2,l-4,l-4,0,0,300,300);const ie=n.toDataURL("image/png");r("companyLogo",ie),A()},A=()=>{E(!1),O(null),x(1),S({x:0,y:0}),N(!1)},Q=s=>{x(parseFloat(s.target.value))},ee=()=>{x(s=>Math.min(s+.05,3))},se=()=>{x(s=>Math.max(s-.1,.5))},te=s=>{const t=s.deltaY>0?-.1:.1;x(n=>Math.min(Math.max(n+t,.5),3))},T=s=>`$${s.toLocaleString()} COP`,u=(s,t,n)=>{z(i=>({...i,[s]:{...i[s],[t]:n}})),C(!1)};return e.jsxs("div",{className:"settings-page",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h1",{children:"⚙️ Settings"}),e.jsx("p",{children:"Configure your application preferences"})]})}),e.jsxs("div",{className:"settings-container",children:[e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx(le,{size:20}),e.jsx("h2",{children:"Contract Settings"})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("label",{htmlFor:"dailyRate",children:[e.jsx($,{size:16}),"Default Daily Rate"]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{id:"dailyRate",type:"number",value:a.dailyRate,onChange:s=>r("dailyRate",parseInt(s.target.value)),step:"1000",min:"0"}),e.jsx("span",{className:"input-hint",children:T(a.dailyRate)})]}),e.jsx("p",{className:"setting-description",children:"The default daily rental rate for new contracts (in cents)"})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("label",{htmlFor:"contractDays",children:[e.jsx(B,{size:16}),"Default Contract Duration"]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{id:"contractDays",type:"number",value:a.contractDays,onChange:s=>r("contractDays",parseInt(s.target.value)),step:"1",min:"1"}),e.jsxs("span",{className:"input-hint",children:[a.contractDays," days"]})]}),e.jsx("p",{className:"setting-description",children:"The default duration for new contracts"})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx(M,{size:20}),e.jsx("h2",{children:"General Settings"}),e.jsx("button",{className:`btn-save-section ${g.general?"btn-saved":""}`,onClick:()=>y("general"),disabled:h.general,children:h.general?"Saving...":g.general?"Saved":e.jsx(j,{size:16})})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"currency",children:"Currency"}),e.jsxs("select",{id:"currency",value:a.currency,onChange:s=>r("currency",s.target.value),children:[e.jsx("option",{value:"COP",children:"COP (Colombian Peso)"}),e.jsx("option",{value:"USD",children:"USD (US Dollar)"}),e.jsx("option",{value:"EUR",children:"EUR (Euro)"})]}),e.jsx("p",{className:"setting-description",children:"Display currency for amounts"})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"timezone",children:"Timezone"}),e.jsxs("select",{id:"timezone",value:a.timezone,onChange:s=>r("timezone",s.target.value),children:[e.jsx("option",{value:"America/Bogota",children:"America/Bogota (UTC-5)"}),e.jsx("option",{value:"America/New_York",children:"America/New_York (UTC-5)"}),e.jsx("option",{value:"America/Los_Angeles",children:"America/Los_Angeles (UTC-8)"}),e.jsx("option",{value:"Europe/London",children:"Europe/London (UTC+0)"})]}),e.jsx("p",{className:"setting-description",children:"Timezone for dates and times"})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"dailyRate",children:"Daily Rate (COP)"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{id:"dailyRate",type:"number",value:a.dailyRate,onChange:s=>r("dailyRate",parseInt(s.target.value)),placeholder:"35000"}),e.jsx("span",{className:"input-hint",children:T(a.dailyRate)})]}),e.jsx("p",{className:"setting-description",children:"Base rate per day in cents"})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"contractDays",children:"Default Contract Days"}),e.jsx("input",{id:"contractDays",type:"number",value:a.contractDays,onChange:s=>r("contractDays",parseInt(s.target.value)),placeholder:"500"}),e.jsx("p",{className:"setting-description",children:"Default duration for new contracts"})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx(R,{size:20}),e.jsx("h2",{children:"Company Branding"}),e.jsx("button",{className:`btn-save-section ${g.branding?"btn-saved":""}`,onClick:()=>y("branding"),disabled:h.branding,children:h.branding?"Saving...":g.branding?"Saved":e.jsx(j,{size:16})})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("label",{htmlFor:"displayName",children:[e.jsx(R,{size:16}),"Company Display Name"]}),e.jsx("input",{id:"displayName",type:"text",value:a.displayName,onChange:s=>r("displayName",s.target.value),placeholder:"PocketBike",className:"input-display-name"}),e.jsx("p",{className:"setting-description",children:"This name will be displayed on the payment page."})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("label",{htmlFor:"companyLogo",children:[e.jsx(R,{size:16}),"Company Logo"]}),e.jsxs("div",{className:"branding-upload-area",children:[e.jsxs("div",{className:"current-logo-container",children:[e.jsx("img",{src:a.companyLogo,alt:"Company Logo",onError:s=>{s.target.src="/pocketbike_60x60.jpg"}}),e.jsx("button",{type:"button",className:"btn-edit-logo",onClick:()=>document.getElementById("companyLogo").click(),title:"Change Logo",children:e.jsx(ge,{size:14})})]}),e.jsx("div",{className:"upload-dropzone",onClick:()=>document.getElementById("companyLogo").click(),children:e.jsx("span",{className:"upload-text",children:"Upload New Logo"})}),e.jsx("input",{id:"companyLogo",type:"file",accept:"image/*",onChange:J,style:{display:"none"}})]}),e.jsx("p",{className:"upload-hint-text",children:"RECOMMENDED: 60X60PX, PNG OR JPG, MAX 2MB"})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx(M,{size:20}),e.jsx("h2",{children:"GPS Service Integration"}),e.jsx("button",{className:`btn-save-section ${g.gps?"btn-saved":""}`,onClick:()=>y("gps"),disabled:h.gps,children:h.gps?"Saving...":g.gps?"Saved":e.jsx(j,{size:16})})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"gpsService",children:"Select Provider"}),e.jsxs("select",{id:"gpsService",value:a.gpsService,onChange:s=>r("gpsService",s.target.value),children:[e.jsx("option",{value:"megarastreo",children:"MegaRastreo"}),e.jsx("option",{value:"traccar",children:"Traccar (Not implemented yet)"})]})]}),a.gpsService==="megarastreo"&&e.jsxs("div",{className:"integration-fields",children:[e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"mrUser",children:"MegaRastreo Username"}),e.jsx("input",{id:"mrUser",type:"text",value:a.gpsConfig.user,onChange:s=>u("gpsConfig","user",s.target.value),placeholder:"Enter username"})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"mrPass",children:"MegaRastreo Password"}),e.jsx("input",{id:"mrPass",type:"password",value:a.gpsConfig.password,onChange:s=>u("gpsConfig","password",s.target.value),placeholder:"Enter password"})]})]}),a.gpsService==="traccar"&&e.jsxs("div",{className:"integration-fields",children:[e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"trHost",children:"Traccar Host"}),e.jsx("input",{id:"trHost",type:"text",value:a.gpsConfig.host,onChange:s=>u("gpsConfig","host",s.target.value),placeholder:"e.g. 198.74.54.252"})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"trUser",children:"Username"}),e.jsx("input",{id:"trUser",type:"text",value:a.gpsConfig.user,onChange:s=>u("gpsConfig","user",s.target.value)})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"trPass",children:"Password"}),e.jsx("input",{id:"trPass",type:"password",value:a.gpsConfig.password,onChange:s=>u("gpsConfig","password",s.target.value)})]})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx($,{size:20}),e.jsx("h2",{children:"Wompi Payments Configuration"}),e.jsx("button",{className:`btn-save-section ${g.wompi?"btn-saved":""}`,onClick:()=>y("wompi"),disabled:h.wompi,children:h.wompi?"Saving...":g.wompi?"Saved":e.jsx(j,{size:16})})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"wPubKey",children:"Public Key"}),e.jsx("input",{id:"wPubKey",type:"text",value:a.wompiConfig.publicKey,onChange:s=>u("wompiConfig","publicKey",s.target.value),placeholder:"pub_test_..."})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"wPrivKey",children:"Private Key"}),e.jsx("input",{id:"wPrivKey",type:"password",value:a.wompiConfig.privateKey,onChange:s=>u("wompiConfig","privateKey",s.target.value),placeholder:"prv_test_..."})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"wInteg",children:"Integrity Secret"}),e.jsx("input",{id:"wInteg",type:"password",value:a.wompiConfig.integritySecret,onChange:s=>u("wompiConfig","integritySecret",s.target.value),placeholder:"test_integrity_..."})]}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"wEvents",children:"Events Secret"}),e.jsx("input",{id:"wEvents",type:"password",value:a.wompiConfig.eventsSecret,onChange:s=>u("wompiConfig","eventsSecret",s.target.value),placeholder:"test_events_..."})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx(B,{size:20}),e.jsx("h2",{children:"Automatic Cut-Off Control"}),e.jsx("button",{className:`btn-save-section ${g.cutoff?"btn-saved":""}`,onClick:()=>y("cutoff"),disabled:h.cutoff,children:h.cutoff?"Saving...":g.cutoff?"Saved":e.jsx(j,{size:16})})]}),e.jsxs("div",{className:"setting-item toggle-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{htmlFor:"automaticCutOff",children:"Enable Automatic Engine Stop"}),e.jsx("p",{className:"setting-description",children:"Automatically turn off engines at 11:59 PM for devices with unpaid invoices."})]}),e.jsx("input",{id:"automaticCutOff",type:"checkbox",checked:a.automaticCutOff,onChange:s=>r("automaticCutOff",s.target.checked),className:"toggle-checkbox"})]}),a.automaticCutOff&&e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{htmlFor:"cutOffStrategy",children:"Cut-Off Strategy"}),e.jsxs("select",{id:"cutOffStrategy",value:a.cutOffStrategy,onChange:s=>r("cutOffStrategy",parseInt(s.target.value)),className:"strategy-select",children:[e.jsx("option",{value:1,children:"1. Invoice de hoy no está pago"}),e.jsx("option",{value:2,children:"2. Invoice de ayer no está pago"}),e.jsx("option",{value:3,children:"3. No apagar / Dejar libre"})]}),e.jsx("p",{className:"setting-description",children:"Choose which payment condition triggers the automatic cutoff."})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx(M,{size:20}),e.jsx("h2",{children:"System Information"})]}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"Application Version"}),e.jsx("div",{className:"info-value",children:"1.0.0"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"Database Status"}),e.jsx("div",{className:"info-value status-connected",children:"Connected"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"API Status"}),e.jsx("div",{className:"info-value status-connected",children:"Active"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"Last Backup"}),e.jsx("div",{className:"info-value",children:"Never"})]})]})]})]}),e.jsx("div",{className:"settings-actions",children:e.jsxs("button",{className:`btn-save ${I?"btn-saved":""}`,onClick:W,children:[e.jsx(j,{}),I?"All Settings Saved!":"Save All Settings"]})}),D&&e.jsx("div",{className:"crop-modal-overlay",children:e.jsxs("div",{className:"crop-modal-content",children:[e.jsx("h3",{className:"crop-modal-title",children:"Crop Your Logo"}),e.jsx("div",{className:"crop-canvas-container",children:e.jsx("canvas",{ref:v,width:600,height:600,className:"crop-canvas",onMouseDown:X,onMouseMove:Z,onMouseUp:U,onMouseLeave:U,onTouchStart:H,onTouchMove:G,onTouchEnd:V,onWheel:te})}),e.jsxs("div",{className:"crop-controls",children:[e.jsxs("div",{className:"zoom-controls",children:[e.jsx("button",{className:"btn-zoom",onClick:se,title:"Zoom Out",children:e.jsx(ve,{size:20})}),e.jsx("input",{type:"range",min:"0.5",max:"3",step:"0.01",value:m,onChange:Q,className:"zoom-slider"}),e.jsx("button",{className:"btn-zoom",onClick:ee,title:"Zoom In",children:e.jsx(ue,{size:20})})]}),e.jsx("p",{className:"crop-hint",children:"Drag to reposition • Use slider to zoom"})]}),e.jsxs("div",{className:"crop-actions",children:[e.jsx("button",{className:"btn-cancel",onClick:A,children:"Cancel"}),e.jsx("button",{className:"btn-crop",onClick:q,children:"Crop & Save"})]})]})})]})};export{be as default};
