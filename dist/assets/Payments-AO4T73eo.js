import{r,j as e}from"./main-D_cgSQuf.js";import{D as L}from"./dollar-sign-BkU3Bhqy.js";import{C as v}from"./check-Bq2xJ7Bd.js";import{C as f}from"./clock-Bf56aCAW.js";import{C as m}from"./credit-card-BjNAvya6.js";import{c as y}from"./createLucideIcon-XZj3iZ8D.js";import{X as A}from"./x-B2EpSVsf.js";import"./modulepreload-polyfill-B5Qt9EMX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],w=y("chevron-left",F);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],V=y("chevron-right",O),Y=()=>{const[i,C]=r.useState([]),[P,h]=r.useState(!0),[n,E]=r.useState("all"),[u,b]=r.useState("date"),[a,d]=r.useState({page:1,limit:20,total:0,totalPages:0,hasNext:!1,hasPrev:!1});r.useEffect(()=>{x()},[a.page,n]);const x=async()=>{h(!0);try{const s=new URLSearchParams({page:a.page.toString(),limit:a.limit.toString()});if(n!=="all"){const o={completed:"APPROVED",pending:"PENDING",failed:"DECLINED"};o[n]&&s.append("status",o[n])}const c=await(await fetch(`/apinode/payments/all?${s}`)).json();c.success?(C(c.payments||[]),d(o=>({...o,...c.pagination}))):console.error("Failed to load payments:",c.error)}catch(s){console.error("Error loading payments:",s)}finally{h(!1)}},j=s=>`$${(s/100).toLocaleString()} COP`,D=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),I=s=>{switch(s.toUpperCase()){case"APPROVED":case"COMPLETED":return e.jsx(v,{});case"DECLINED":case"FAILED":case"ERROR":return e.jsx(A,{});case"PENDING":case"VERIFYING":return e.jsx(f,{});default:return e.jsx(m,{})}},p=s=>{switch(s.toUpperCase()){case"APPROVED":case"COMPLETED":return"#00C292";case"DECLINED":case"FAILED":case"ERROR":return"#EF4444";case"PENDING":case"VERIFYING":return"#FB9678";default:return"#6B7280"}},N=[...i].sort((s,t)=>{switch(u){case"date":return new Date(t.createdAt)-new Date(s.createdAt);case"amount":return t.amount-s.amount;case"device":return s.deviceId.localeCompare(t.deviceId);default:return 0}}),R=i.reduce((s,t)=>{const c=t.status.toUpperCase();return c==="APPROVED"||c==="COMPLETED"?s+t.amount:s},0),S=i.filter(s=>{const t=s.status.toUpperCase();return t==="APPROVED"||t==="COMPLETED"}).length,k=i.filter(s=>{const t=s.status.toUpperCase();return t==="PENDING"||t==="VERIFYING"}).length,g=s=>{d(t=>({...t,page:s}))},l=s=>{E(s),d(t=>({...t,page:1}))};return e.jsxs("div",{className:"payments-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"ðŸ’³ Payments History"}),e.jsx("p",{children:"View and manage all payment transactions"})]}),e.jsx("button",{className:"btn-primary",onClick:x,children:"ðŸ”„ Refresh"})]}),e.jsxs("div",{className:"payment-stats",children:[e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#03C9D7"},children:e.jsx(L,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:"Total Revenue (Current Page)"}),e.jsx("div",{className:"stat-number",children:j(R)})]})]}),e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#00C292"},children:e.jsx(v,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:"Completed (Page)"}),e.jsx("div",{className:"stat-number",children:S})]})]}),e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#FB9678"},children:e.jsx(f,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:"Pending (Page)"}),e.jsx("div",{className:"stat-number",children:k})]})]}),e.jsxs("div",{className:"payment-stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"#7460EE"},children:e.jsx(m,{size:20})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-label",children:"Total Transactions"}),e.jsx("div",{className:"stat-number",children:a.total})]})]})]}),e.jsxs("div",{className:"payment-controls",children:[e.jsxs("div",{className:"payment-filters",children:[e.jsx("button",{className:`filter-btn ${n==="all"?"active":""}`,onClick:()=>l("all"),children:"All"}),e.jsx("button",{className:`filter-btn ${n==="completed"?"active":""}`,onClick:()=>l("completed"),children:"Completed"}),e.jsx("button",{className:`filter-btn ${n==="pending"?"active":""}`,onClick:()=>l("pending"),children:"Pending"}),e.jsx("button",{className:`filter-btn ${n==="failed"?"active":""}`,onClick:()=>l("failed"),children:"Failed"})]}),e.jsxs("select",{className:"sort-select",value:u,onChange:s=>b(s.target.value),children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"amount",children:"Sort by Amount"}),e.jsx("option",{value:"device",children:"Sort by Device"})]})]}),e.jsx("div",{className:"payments-table-container",children:P?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading payments..."})]}):N.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(m,{size:48}),e.jsx("h3",{children:"No payments found"}),e.jsx("p",{children:"No transactions match your current filter"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"payments-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment ID"}),e.jsx("th",{children:"Device"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Method"}),e.jsx("th",{children:"Date"})]})}),e.jsx("tbody",{children:N.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"payment-id",children:e.jsx("code",{children:s.paymentId})}),e.jsx("td",{children:e.jsx("strong",{children:s.deviceId})}),e.jsx("td",{className:"amount",children:j(s.amount)}),e.jsx("td",{children:e.jsxs("span",{className:"status-badge",style:{background:`${p(s.status)}20`,color:p(s.status)},children:[I(s.status),s.status]})}),e.jsx("td",{className:"payment-method",children:s.paymentMethod||"N/A"}),e.jsx("td",{className:"date",children:D(s.createdAt)})]},s.paymentId))})]}),a.totalPages>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("button",{className:"pagination-btn",onClick:()=>g(a.page-1),disabled:!a.hasPrev,children:[e.jsx(w,{})," Previous"]}),e.jsxs("span",{className:"pagination-info",children:["Page ",a.page," of ",a.totalPages,"(",a.total," total)"]}),e.jsxs("button",{className:"pagination-btn",onClick:()=>g(a.page+1),disabled:!a.hasNext,children:["Next ",e.jsx(V,{})]})]})]})})]})};export{Y as default};
