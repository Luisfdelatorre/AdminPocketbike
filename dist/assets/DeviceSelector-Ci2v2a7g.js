import{r as E,j as t,R as M,a as ve,u as pe,c as ye,d as Ne,s as be,e as Ce,f as we,h as je,i as Ee}from"./main-CfsT50y0.js";import{s as I}from"./toast-DASUAV0i.js";import{u as W}from"./useTranslation-Dr7ilz_7.js";import{c as O}from"./createLucideIcon-BVLfzT-S.js";import{P as se}from"./plus-BRaefUQd.js";import{U as Me}from"./users-CYM2wYj2.js";import{S as Se}from"./search-CPdBVXh6.js";import{X as Ae}from"./x-B5cEk_pk.js";import{S as ke}from"./square-pen-BzEKBfJ7.js";import"./modulepreload-polyfill-B5Qt9EMX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M10 10v4",key:"1mb2ec"}],["path",{d:"M14 10v4",key:"1nt88p"}],["path",{d:"M22 14v-4",key:"14q9d5"}],["path",{d:"M6 10v4",key:"1n77qd"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],Pe=O("battery-full",Re);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M22 14v-4",key:"14q9d5"}],["path",{d:"M6 14v-4",key:"14a6bd"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],Le=O("battery-low",Ie);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M10 14v-4",key:"suye4c"}],["path",{d:"M22 14v-4",key:"14q9d5"}],["path",{d:"M6 14v-4",key:"14a6bd"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],Fe=O("battery-medium",De);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Oe=O("circle-check-big",ze);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Be=O("circle",_e);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],$e=O("copy",Te);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],J=O("refresh-cw",Ue);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],He=O("share-2",Qe),qe=({isOpen:c,onClose:o,onSubmit:a,formData:d,setFormData:u,isEditing:m})=>{const{t:b}=W();return E.useEffect(()=>(c&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="unset"}),[c]),c?t.jsx("div",{className:"modal-overlay",onClick:o,children:t.jsxs("div",{className:"modal-content",onClick:g=>g.stopPropagation(),onMouseDown:g=>g.stopPropagation(),children:[t.jsx("h2",{children:b(m?"devices.form.editTitle":"devices.form.addTitle")}),t.jsxs("form",{onSubmit:a,children:[t.jsxs("div",{className:"form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:b("devices.form.deviceId")}),t.jsx("input",{type:"text",value:d._id,onChange:g=>u({...d,_id:g.target.value}),disabled:m,required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:b("devices.form.name")}),t.jsx("input",{type:"text",value:d.deviceName,onChange:g=>u({...d,deviceName:g.target.value}),required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:b("devices.form.nequi")}),t.jsx("input",{type:"text",value:d.nequiNumber,onChange:g=>u({...d,nequiNumber:g.target.value})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:b("devices.form.sim")}),t.jsx("input",{type:"text",value:d.simCardNumber,onChange:g=>u({...d,simCardNumber:g.target.value})})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:b("devices.form.notes")}),t.jsx("textarea",{value:d.notes,onChange:g=>u({...d,notes:g.target.value}),rows:"3"})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:d.isActive,onChange:g=>u({...d,isActive:g.target.checked})}),b("devices.form.active")]})}),t.jsxs("div",{className:"modal-actions",children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:o,children:b("common.cancel")}),t.jsx("button",{type:"submit",className:"btn-primary",children:b(m?"common.update":"common.create")})]})]})]})}):null};var Ge=Object.defineProperty,X=Object.getOwnPropertySymbols,ne=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,re=(c,o,a)=>o in c?Ge(c,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[o]=a,ee=(c,o)=>{for(var a in o||(o={}))ne.call(o,a)&&re(c,a,o[a]);if(X)for(var a of X(o))ie.call(o,a)&&re(c,a,o[a]);return c},te=(c,o)=>{var a={};for(var d in c)ne.call(c,d)&&o.indexOf(d)<0&&(a[d]=c[d]);if(c!=null&&X)for(var d of X(c))o.indexOf(d)<0&&ie.call(c,d)&&(a[d]=c[d]);return a};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var _;(c=>{const o=class y{constructor(e,r,s,n){if(this.version=e,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],e<y.MIN_VERSION||e>y.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=e*4+17;let i=[];for(let h=0;h<this.size;h++)i.push(!1);for(let h=0;h<this.size;h++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();const f=this.addEccAndInterleave(s);if(this.drawCodewords(f),n==-1){let h=1e9;for(let p=0;p<8;p++){this.applyMask(p),this.drawFormatBits(p);const x=this.getPenaltyScore();x<h&&(n=p,h=x),this.applyMask(p)}}u(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}static encodeText(e,r){const s=c.QrSegment.makeSegments(e);return y.encodeSegments(s,r)}static encodeBinary(e,r){const s=c.QrSegment.makeBytes(e);return y.encodeSegments([s],r)}static encodeSegments(e,r,s=1,n=40,i=-1,f=!0){if(!(y.MIN_VERSION<=s&&s<=n&&n<=y.MAX_VERSION)||i<-1||i>7)throw new RangeError("Invalid value");let h,p;for(h=s;;h++){const v=y.getNumDataCodewords(h,r)*8,C=b.getTotalBits(e,h);if(C<=v){p=C;break}if(h>=n)throw new RangeError("Data too long")}for(const v of[y.Ecc.MEDIUM,y.Ecc.QUARTILE,y.Ecc.HIGH])f&&p<=y.getNumDataCodewords(h,v)*8&&(r=v);let x=[];for(const v of e){a(v.mode.modeBits,4,x),a(v.numChars,v.mode.numCharCountBits(h),x);for(const C of v.getData())x.push(C)}u(x.length==p);const S=y.getNumDataCodewords(h,r)*8;u(x.length<=S),a(0,Math.min(4,S-x.length),x),a(0,(8-x.length%8)%8,x),u(x.length%8==0);for(let v=236;x.length<S;v^=253)a(v,8,x);let j=[];for(;j.length*8<x.length;)j.push(0);return x.forEach((v,C)=>j[C>>>3]|=v<<7-(C&7)),new y(h,r,j,i)}getModule(e,r){return 0<=e&&e<this.size&&0<=r&&r<this.size&&this.modules[r][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),r=e.length;for(let s=0;s<r;s++)for(let n=0;n<r;n++)s==0&&n==0||s==0&&n==r-1||s==r-1&&n==0||this.drawAlignmentPattern(e[s],e[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const r=this.errorCorrectionLevel.formatBits<<3|e;let s=r;for(let i=0;i<10;i++)s=s<<1^(s>>>9)*1335;const n=(r<<10|s)^21522;u(n>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,d(n,i));this.setFunctionModule(8,7,d(n,6)),this.setFunctionModule(8,8,d(n,7)),this.setFunctionModule(7,8,d(n,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,d(n,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,d(n,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,d(n,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let s=0;s<12;s++)e=e<<1^(e>>>11)*7973;const r=this.version<<12|e;u(r>>>18==0);for(let s=0;s<18;s++){const n=d(r,s),i=this.size-11+s%3,f=Math.floor(s/3);this.setFunctionModule(i,f,n),this.setFunctionModule(f,i,n)}}drawFinderPattern(e,r){for(let s=-4;s<=4;s++)for(let n=-4;n<=4;n++){const i=Math.max(Math.abs(n),Math.abs(s)),f=e+n,h=r+s;0<=f&&f<this.size&&0<=h&&h<this.size&&this.setFunctionModule(f,h,i!=2&&i!=4)}}drawAlignmentPattern(e,r){for(let s=-2;s<=2;s++)for(let n=-2;n<=2;n++)this.setFunctionModule(e+n,r+s,Math.max(Math.abs(n),Math.abs(s))!=1)}setFunctionModule(e,r,s){this.modules[r][e]=s,this.isFunction[r][e]=!0}addEccAndInterleave(e){const r=this.version,s=this.errorCorrectionLevel;if(e.length!=y.getNumDataCodewords(r,s))throw new RangeError("Invalid argument");const n=y.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][r],i=y.ECC_CODEWORDS_PER_BLOCK[s.ordinal][r],f=Math.floor(y.getNumRawDataModules(r)/8),h=n-f%n,p=Math.floor(f/n);let x=[];const S=y.reedSolomonComputeDivisor(i);for(let v=0,C=0;v<n;v++){let k=e.slice(C,C+p-i+(v<h?0:1));C+=k.length;const L=y.reedSolomonComputeRemainder(k,S);v<h&&k.push(0),x.push(k.concat(L))}let j=[];for(let v=0;v<x[0].length;v++)x.forEach((C,k)=>{(v!=p-i||k>=h)&&j.push(C[v])});return u(j.length==f),j}drawCodewords(e){if(e.length!=Math.floor(y.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let r=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let n=0;n<this.size;n++)for(let i=0;i<2;i++){const f=s-i,p=(s+1&2)==0?this.size-1-n:n;!this.isFunction[p][f]&&r<e.length*8&&(this.modules[p][f]=d(e[r>>>3],7-(r&7)),r++)}}u(r==e.length*8)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let r=0;r<this.size;r++)for(let s=0;s<this.size;s++){let n;switch(e){case 0:n=(s+r)%2==0;break;case 1:n=r%2==0;break;case 2:n=s%3==0;break;case 3:n=(s+r)%3==0;break;case 4:n=(Math.floor(s/3)+Math.floor(r/2))%2==0;break;case 5:n=s*r%2+s*r%3==0;break;case 6:n=(s*r%2+s*r%3)%2==0;break;case 7:n=((s+r)%2+s*r%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[r][s]&&n&&(this.modules[r][s]=!this.modules[r][s])}}getPenaltyScore(){let e=0;for(let i=0;i<this.size;i++){let f=!1,h=0,p=[0,0,0,0,0,0,0];for(let x=0;x<this.size;x++)this.modules[i][x]==f?(h++,h==5?e+=y.PENALTY_N1:h>5&&e++):(this.finderPenaltyAddHistory(h,p),f||(e+=this.finderPenaltyCountPatterns(p)*y.PENALTY_N3),f=this.modules[i][x],h=1);e+=this.finderPenaltyTerminateAndCount(f,h,p)*y.PENALTY_N3}for(let i=0;i<this.size;i++){let f=!1,h=0,p=[0,0,0,0,0,0,0];for(let x=0;x<this.size;x++)this.modules[x][i]==f?(h++,h==5?e+=y.PENALTY_N1:h>5&&e++):(this.finderPenaltyAddHistory(h,p),f||(e+=this.finderPenaltyCountPatterns(p)*y.PENALTY_N3),f=this.modules[x][i],h=1);e+=this.finderPenaltyTerminateAndCount(f,h,p)*y.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let f=0;f<this.size-1;f++){const h=this.modules[i][f];h==this.modules[i][f+1]&&h==this.modules[i+1][f]&&h==this.modules[i+1][f+1]&&(e+=y.PENALTY_N2)}let r=0;for(const i of this.modules)r=i.reduce((f,h)=>f+(h?1:0),r);const s=this.size*this.size,n=Math.ceil(Math.abs(r*20-s*10)/s)-1;return u(0<=n&&n<=9),e+=n*y.PENALTY_N4,u(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(this.version==1)return[];{const e=Math.floor(this.version/7)+2,r=this.version==32?26:Math.ceil((this.version*4+4)/(e*2-2))*2;let s=[6];for(let n=this.size-7;s.length<e;n-=r)s.splice(1,0,n);return s}}static getNumRawDataModules(e){if(e<y.MIN_VERSION||e>y.MAX_VERSION)throw new RangeError("Version number out of range");let r=(16*e+128)*e+64;if(e>=2){const s=Math.floor(e/7)+2;r-=(25*s-10)*s-55,e>=7&&(r-=36)}return u(208<=r&&r<=29648),r}static getNumDataCodewords(e,r){return Math.floor(y.getNumRawDataModules(e)/8)-y.ECC_CODEWORDS_PER_BLOCK[r.ordinal][e]*y.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let r=[];for(let n=0;n<e-1;n++)r.push(0);r.push(1);let s=1;for(let n=0;n<e;n++){for(let i=0;i<r.length;i++)r[i]=y.reedSolomonMultiply(r[i],s),i+1<r.length&&(r[i]^=r[i+1]);s=y.reedSolomonMultiply(s,2)}return r}static reedSolomonComputeRemainder(e,r){let s=r.map(n=>0);for(const n of e){const i=n^s.shift();s.push(0),r.forEach((f,h)=>s[h]^=y.reedSolomonMultiply(f,i))}return s}static reedSolomonMultiply(e,r){if(e>>>8||r>>>8)throw new RangeError("Byte out of range");let s=0;for(let n=7;n>=0;n--)s=s<<1^(s>>>7)*285,s^=(r>>>n&1)*e;return u(s>>>8==0),s}finderPenaltyCountPatterns(e){const r=e[1];u(r<=this.size*3);const s=r>0&&e[2]==r&&e[3]==r*3&&e[4]==r&&e[5]==r;return(s&&e[0]>=r*4&&e[6]>=r?1:0)+(s&&e[6]>=r*4&&e[0]>=r?1:0)}finderPenaltyTerminateAndCount(e,r,s){return e&&(this.finderPenaltyAddHistory(r,s),r=0),r+=this.size,this.finderPenaltyAddHistory(r,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(e,r){r[0]==0&&(e+=this.size),r.pop(),r.unshift(e)}};o.MIN_VERSION=1,o.MAX_VERSION=40,o.PENALTY_N1=3,o.PENALTY_N2=3,o.PENALTY_N3=40,o.PENALTY_N4=10,o.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],o.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],c.QrCode=o;function a(g,e,r){if(e<0||e>31||g>>>e)throw new RangeError("Value out of range");for(let s=e-1;s>=0;s--)r.push(g>>>s&1)}function d(g,e){return(g>>>e&1)!=0}function u(g){if(!g)throw new Error("Assertion error")}const m=class w{constructor(e,r,s){if(this.mode=e,this.numChars=r,this.bitData=s,r<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(e){let r=[];for(const s of e)a(s,8,r);return new w(w.Mode.BYTE,e.length,r)}static makeNumeric(e){if(!w.isNumeric(e))throw new RangeError("String contains non-numeric characters");let r=[];for(let s=0;s<e.length;){const n=Math.min(e.length-s,3);a(parseInt(e.substring(s,s+n),10),n*3+1,r),s+=n}return new w(w.Mode.NUMERIC,e.length,r)}static makeAlphanumeric(e){if(!w.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let r=[],s;for(s=0;s+2<=e.length;s+=2){let n=w.ALPHANUMERIC_CHARSET.indexOf(e.charAt(s))*45;n+=w.ALPHANUMERIC_CHARSET.indexOf(e.charAt(s+1)),a(n,11,r)}return s<e.length&&a(w.ALPHANUMERIC_CHARSET.indexOf(e.charAt(s)),6,r),new w(w.Mode.ALPHANUMERIC,e.length,r)}static makeSegments(e){return e==""?[]:w.isNumeric(e)?[w.makeNumeric(e)]:w.isAlphanumeric(e)?[w.makeAlphanumeric(e)]:[w.makeBytes(w.toUtf8ByteArray(e))]}static makeEci(e){let r=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)a(e,8,r);else if(e<16384)a(2,2,r),a(e,14,r);else if(e<1e6)a(6,3,r),a(e,21,r);else throw new RangeError("ECI assignment value out of range");return new w(w.Mode.ECI,0,r)}static isNumeric(e){return w.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return w.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,r){let s=0;for(const n of e){const i=n.mode.numCharCountBits(r);if(n.numChars>=1<<i)return 1/0;s+=4+i+n.bitData.length}return s}static toUtf8ByteArray(e){e=encodeURI(e);let r=[];for(let s=0;s<e.length;s++)e.charAt(s)!="%"?r.push(e.charCodeAt(s)):(r.push(parseInt(e.substring(s+1,s+3),16)),s+=2);return r}};m.NUMERIC_REGEX=/^[0-9]*$/,m.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,m.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let b=m;c.QrSegment=m})(_||(_={}));(c=>{(o=>{const a=class{constructor(u,m){this.ordinal=u,this.formatBits=m}};a.LOW=new a(0,1),a.MEDIUM=new a(1,0),a.QUARTILE=new a(2,3),a.HIGH=new a(3,2),o.Ecc=a})(c.QrCode||(c.QrCode={}))})(_||(_={}));(c=>{(o=>{const a=class{constructor(u,m){this.modeBits=u,this.numBitsCharCount=m}numCharCountBits(u){return this.numBitsCharCount[Math.floor((u+7)/17)]}};a.NUMERIC=new a(1,[10,12,14]),a.ALPHANUMERIC=new a(2,[9,11,13]),a.BYTE=new a(4,[8,16,16]),a.KANJI=new a(8,[8,10,12]),a.ECI=new a(7,[0,0,0]),o.Mode=a})(c.QrSegment||(c.QrSegment={}))})(_||(_={}));var Q=_;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Ye={L:Q.QrCode.Ecc.LOW,M:Q.QrCode.Ecc.MEDIUM,Q:Q.QrCode.Ecc.QUARTILE,H:Q.QrCode.Ecc.HIGH},ae=128,le="L",oe="#FFFFFF",ce="#000000",de=!1,he=1,Ve=4,Xe=0,We=.1;function ue(c,o=0){const a=[];return c.forEach(function(d,u){let m=null;d.forEach(function(b,g){if(!b&&m!==null){a.push(`M${m+o} ${u+o}h${g-m}v1H${m+o}z`),m=null;return}if(g===d.length-1){if(!b)return;m===null?a.push(`M${g+o},${u+o} h1v1H${g+o}z`):a.push(`M${m+o},${u+o} h${g+1-m}v1H${m+o}z`);return}b&&m===null&&(m=g)})}),a.join("")}function me(c,o){return c.slice().map((a,d)=>d<o.y||d>=o.y+o.h?a:a.map((u,m)=>m<o.x||m>=o.x+o.w?u:!1))}function Ke(c,o,a,d){if(d==null)return null;const u=c.length+a*2,m=Math.floor(o*We),b=u/o,g=(d.width||m)*b,e=(d.height||m)*b,r=d.x==null?c.length/2-g/2:d.x*b,s=d.y==null?c.length/2-e/2:d.y*b,n=d.opacity==null?1:d.opacity;let i=null;if(d.excavate){let h=Math.floor(r),p=Math.floor(s),x=Math.ceil(g+r-h),S=Math.ceil(e+s-p);i={x:h,y:p,w:x,h:S}}const f=d.crossOrigin;return{x:r,y:s,h:e,w:g,excavation:i,opacity:n,crossOrigin:f}}function Ze(c,o){return o!=null?Math.max(Math.floor(o),0):c?Ve:Xe}function fe({value:c,level:o,minVersion:a,includeMargin:d,marginSize:u,imageSettings:m,size:b,boostLevel:g}){let e=M.useMemo(()=>{const h=(Array.isArray(c)?c:[c]).reduce((p,x)=>(p.push(...Q.QrSegment.makeSegments(x)),p),[]);return Q.QrCode.encodeSegments(h,Ye[o],a,void 0,void 0,g)},[c,o,a,g]);const{cells:r,margin:s,numCells:n,calculatedImageSettings:i}=M.useMemo(()=>{let f=e.getModules();const h=Ze(d,u),p=f.length+h*2,x=Ke(f,b,h,m);return{cells:f,margin:h,numCells:p,calculatedImageSettings:x}},[e,b,m,d,u]);return{qrcode:e,margin:s,cells:r,numCells:n,calculatedImageSettings:i}}var Je=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),et=M.forwardRef(function(o,a){const d=o,{value:u,size:m=ae,level:b=le,bgColor:g=oe,fgColor:e=ce,includeMargin:r=de,minVersion:s=he,boostLevel:n,marginSize:i,imageSettings:f}=d,p=te(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:x}=p,S=te(p,["style"]),j=f==null?void 0:f.src,v=M.useRef(null),C=M.useRef(null),k=M.useCallback(D=>{v.current=D,typeof a=="function"?a(D):a&&(a.current=D)},[a]),[L,B]=M.useState(!1),{margin:R,cells:T,numCells:$,calculatedImageSettings:A}=fe({value:u,level:b,minVersion:s,boostLevel:n,includeMargin:r,marginSize:i,imageSettings:f,size:m});M.useEffect(()=>{if(v.current!=null){const D=v.current,P=D.getContext("2d");if(!P)return;let F=T;const z=C.current,q=A!=null&&z!==null&&z.complete&&z.naturalHeight!==0&&z.naturalWidth!==0;q&&A.excavation!=null&&(F=me(T,A.excavation));const G=window.devicePixelRatio||1;D.height=D.width=m*G;const Y=m/$*G;P.scale(Y,Y),P.fillStyle=g,P.fillRect(0,0,$,$),P.fillStyle=e,Je?P.fill(new Path2D(ue(F,R))):T.forEach(function(K,V){K.forEach(function(l,N){l&&P.fillRect(N+R,V+R,1,1)})}),A&&(P.globalAlpha=A.opacity),q&&P.drawImage(z,A.x+R,A.y+R,A.w,A.h)}}),M.useEffect(()=>{B(!1)},[j]);const H=ee({height:m,width:m},x);let U=null;return j!=null&&(U=M.createElement("img",{src:j,key:j,style:{display:"none"},onLoad:()=>{B(!0)},ref:C,crossOrigin:A==null?void 0:A.crossOrigin})),M.createElement(M.Fragment,null,M.createElement("canvas",ee({style:H,height:m,width:m,ref:k,role:"img"},S)),U)});et.displayName="QRCodeCanvas";var xe=M.forwardRef(function(o,a){const d=o,{value:u,size:m=ae,level:b=le,bgColor:g=oe,fgColor:e=ce,includeMargin:r=de,minVersion:s=he,boostLevel:n,title:i,marginSize:f,imageSettings:h}=d,p=te(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:x,cells:S,numCells:j,calculatedImageSettings:v}=fe({value:u,level:b,minVersion:s,boostLevel:n,includeMargin:r,marginSize:f,imageSettings:h,size:m});let C=S,k=null;h!=null&&v!=null&&(v.excavation!=null&&(C=me(S,v.excavation)),k=M.createElement("image",{href:h.src,height:v.h,width:v.w,x:v.x+x,y:v.y+x,preserveAspectRatio:"none",opacity:v.opacity,crossOrigin:v.crossOrigin}));const L=ue(C,x);return M.createElement("svg",ee({height:m,width:m,viewBox:`0 0 ${j} ${j}`,ref:a,role:"img"},p),!!i&&M.createElement("title",null,i),M.createElement("path",{fill:g,d:`M0,0 h${j}v${j}H0z`,shapeRendering:"crispEdges"}),M.createElement("path",{fill:e,d:L,shapeRendering:"crispEdges"}),k)});xe.displayName="QRCodeSVG";const tt=({isOpen:c,onClose:o,shareUrl:a,onCopy:d})=>{const{t:u}=W();return c?t.jsx("div",{className:"modal-overlay",onClick:o,children:t.jsxs("div",{className:"modal-content",onClick:m=>m.stopPropagation(),children:[t.jsx("h2",{children:u("devices.share.title")}),t.jsx("p",{children:u("devices.share.subtitle")}),t.jsx("div",{className:"qr-code-display",style:{display:"flex",justifyContent:"center",margin:"1.5rem 0",padding:"1rem",background:"white",borderRadius:"0.5rem"},children:t.jsx(xe,{value:a,size:200})}),t.jsxs("div",{className:"share-link-box",style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",background:"#F3F4F6",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #E5E7EB"},children:[t.jsx("input",{type:"text",value:a,readOnly:!0,style:{flex:1,background:"transparent",border:"none",fontSize:"0.875rem",color:"#4B5563",outline:"none"}}),t.jsxs("button",{onClick:d,style:{background:"none",border:"none",cursor:"pointer",color:"#03C9D7",display:"flex",alignItems:"center",gap:"0.25rem"},children:[t.jsx($e,{})," ",u("devices.share.copy")]})]}),t.jsxs("div",{className:"pin-warning",style:{background:"#FEF3C7",color:"#92400E",padding:"0.75rem",borderRadius:"0.5rem",fontSize:"0.875rem",marginBottom:"1.5rem"},children:[t.jsx("strong",{children:u("devices.share.note")})," ",u("devices.share.noteText")]}),t.jsx("button",{className:"btn-primary full-width",onClick:o,children:u("common.done")})]})}):null},st=({isOpen:c,onClose:o,onConfirm:a,deviceId:d})=>{const{t:u}=W();return c?t.jsx("div",{className:"modal-overlay",onClick:o,children:t.jsxs("div",{className:"modal-content",onClick:m=>m.stopPropagation(),style:{maxWidth:"400px"},children:[t.jsx("h2",{children:u("common.confirmDelete")}),t.jsxs("p",{children:[u("devices.deleteConfirmText")," ",t.jsx("strong",{children:d}),"?"]}),t.jsx("p",{style:{color:"#6B7280",fontSize:"0.875rem",marginTop:"0.5rem"},children:u("devices.deleteNote")}),t.jsxs("div",{className:"modal-actions",children:[t.jsx("button",{className:"btn-secondary",onClick:o,children:u("common.cancel")}),t.jsx("button",{className:"btn-primary",style:{background:"#EF4444"},onClick:a,children:u("common.delete")})]})]})}):null},rt=({children:c})=>{const[o,a]=E.useState(null);return E.useEffect(()=>{a(document.getElementById("mobile-header-actions"))},[]),o?Ce.createPortal(c,o):null},gt=()=>{ve();const{t:c}=W(),{user:o}=pe(),[a,d]=E.useState([]),[u,m]=E.useState(!0),[b,g]=E.useState(!1),[e,r]=E.useState(null),[s,n]=E.useState(!1),[i,f]=E.useState(""),[h,p]=E.useState(""),[x,S]=E.useState(""),[j,v]=E.useState(!1),[C,k]=E.useState(null),[L,B]=E.useState("all"),[R,T]=E.useState("technical"),[$,A]=E.useState(null),[H,U]=E.useState({_id:"",deviceName:"",nequiNumber:"",simCardNumber:"",isActive:!0,notes:""});E.useEffect(()=>{F()},[R]),E.useEffect(()=>{const l=N=>{$&&!N.target.closest(".action-menu-container")&&A(null)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[$]);const D=l=>{const N=`${window.location.origin}/p/${l.name}`;f(N),p(l.deviceId),n(!0)},P=async()=>{try{await navigator.clipboard.writeText(i)}catch(l){console.error("Failed to copy text: ",l);const N=document.createElement("textarea");N.value=i,document.body.appendChild(N),N.focus(),N.select(),N.setSelectionRange(0,99999);try{document.execCommand("copy")}catch(Z){console.error("Unable to copy",Z),I("Failed to copy link manually.","error")}document.body.removeChild(N)}},F=async()=>{m(!0);try{let l;if(R!=="financial"){const N=await ye();console.log(N),l={success:!0,devices:N}}else l=await Ne();l.success&&d(l.devices||[])}catch(l){console.error("Error fetching devices:",l),I("Failed to load devices","error")}finally{m(!1)}},z=async()=>{console.log("Sync button clicked"),console.log("Starting sync..."),m(!0);try{const l=await be();console.log("Sync result:",l),l.success?(I(l.message,"success"),F()):I(l.error||"Sync failed","error")}catch(l){console.error("Error syncing devices:",l),I("Failed to sync devices: "+l.message,"error")}finally{m(!1)}},q=()=>{r(null),U({_id:"",deviceName:"",nequiNumber:"",simCardNumber:"",isActive:!0,notes:""}),g(!0)},G=l=>{r(l),U({_id:l._id,deviceName:l.deviceName,nequiNumber:l.nequiNumber||"",simCardNumber:l.simCardNumber||"",isActive:l.isActive,notes:l.notes||""}),g(!0)},Y=async l=>{l.preventDefault();try{const N=e?await we(e._id,H):await je(H);N.success?(g(!1),F(),I(e?"Device updated successfully":"Device created successfully","success")):I(N.error||"Failed to save device","error")}catch(N){console.error("Error saving device:",N),I("Failed to save device","error")}},K=async()=>{if(!C)return;const l=C._id;try{const N=await Ee(l);N.success?(F(),v(!1),k(null),I("Device deactivated successfully","success")):I(N.error,"error")}catch(N){console.error("Error deleting device:",N),I(`Failed to delete device: ${N.message||"Unknown error"}`,"error")}},V=a.filter(l=>{if(x){const N=x.toLowerCase(),Z=l.name||l.deviceName||"",ge=l._id||"";if(!String(ge).includes(N)&&!Z.toLowerCase().includes(N))return!1}return!(L==="active"&&!l.hasActiveContract||L==="available"&&(l.hasActiveContract||!l.isActive))});return u?t.jsx("div",{className:"devices-page",children:t.jsxs("div",{className:"loading-state",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:c("common.loading")})]})}):t.jsxs("div",{className:"devices-page",children:[t.jsxs("div",{className:"page-header",children:[t.jsx("div",{className:"desktop-only",children:t.jsx("h1",{children:c("devices.title")})}),o!=null&&o.isSuperAdmin?t.jsxs("button",{className:"btn-secondary desktop-only",onClick:z,disabled:u,style:{marginRight:"1rem"},children:[t.jsx(J,{className:u?"spin":""})," ",c("devices.sync")]}):t.jsxs("button",{className:"btn-secondary desktop-only",onClick:F,disabled:u,style:{marginRight:"1rem"},children:[t.jsx(J,{className:u?"spin":""})," ",c("payments.refresh")]}),t.jsxs("button",{className:"btn-primary desktop-only",onClick:q,children:[t.jsx(se,{})," ",c("devices.addDevice")]}),t.jsxs(rt,{children:[t.jsx("button",{onClick:q,className:"btn-mobile-header-action",children:t.jsx(se,{size:24})}),t.jsx("button",{onClick:o!=null&&o.isSuperAdmin?z:F,className:"btn-mobile-header-action",children:t.jsx(J,{size:20,className:u?"spin":""})})]})]}),t.jsxs("div",{className:"devices-stats desktop-only",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-icon",style:{background:"#03C9D7"},children:t.jsx(Me,{})}),t.jsxs("div",{className:"stat-info",children:[t.jsx("div",{className:"stat-label",children:c("devices.totalDevices")}),t.jsx("div",{className:"stat-number",children:a.length})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-icon",style:{background:"#00C292"},children:t.jsx(Oe,{})}),t.jsxs("div",{className:"stat-info",children:[t.jsx("div",{className:"stat-label",children:c("devices.activeContracts")}),t.jsx("div",{className:"stat-number",children:a.filter(l=>l.hasActiveContract).length})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-icon",style:{background:"#FB9678"},children:t.jsx(Be,{})}),t.jsxs("div",{className:"stat-info",children:[t.jsx("div",{className:"stat-label",children:c("devices.available")}),t.jsx("div",{className:"stat-number",children:a.filter(l=>!l.hasActiveContract&&l.isActive).length})]})]})]}),t.jsx("div",{className:"flex justify-center mb-4",children:t.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg inline-flex",children:[t.jsx("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${R==="technical"?"bg-white shadow text-gray-900":"text-gray-500 hover:text-gray-900"}`,onClick:()=>T("technical"),children:"Técnico"}),t.jsx("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${R==="financial"?"bg-white shadow text-gray-900":"text-gray-500 hover:text-gray-900"}`,onClick:()=>T("financial"),children:"Financiero"})]})}),t.jsx("div",{className:"devices-search",children:t.jsxs("div",{className:"search-box",children:[t.jsx(Se,{className:"search-icon"}),t.jsx("input",{type:"text",placeholder:c("devices.searchPlaceholder"),value:x,onChange:l=>S(l.target.value)}),x&&t.jsx("button",{className:"clear-search",onClick:()=>S(""),children:t.jsx(Ae,{})})]})}),t.jsxs("div",{className:"devices-filters",children:[t.jsx("button",{className:`filter-btn ${L==="all"?"active":""}`,onClick:()=>B("all"),children:c("devices.filterAll")}),t.jsx("button",{className:`filter-btn ${L==="active"?"active":""}`,onClick:()=>B("active"),children:c("devices.filterActive")}),t.jsx("button",{className:`filter-btn ${L==="available"?"active":""}`,onClick:()=>B("available"),children:c("devices.filterAvailable")})]}),t.jsxs("div",{className:"w-full bg-white rounded-2xl shadow-sm border border-gray-100",children:[t.jsxs("div",{className:"grid grid-cols-4 lg:grid-cols-7 gap-6 px-2 py-2 border-b border-gray-100",children:[t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center",children:c("devices.table.contract")}),R==="technical"?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center",children:"Pagado"}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase hidden lg:flex items-center",children:"Deuda"}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase hidden lg:flex items-center",children:"Estado"}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase hidden lg:flex items-center",children:"Dias Libres"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase hidden lg:flex items-center",children:c("devices.table.driver")}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center",children:"Tarifa"}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-blue-600 uppercase flex items-center",children:"Pagado"}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-red-600 uppercase flex items-center",children:"Deuda"}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-blue-600 uppercase flex items-center",children:"Días Free"})]}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center justify-center",children:"Motor"}),t.jsx("div",{className:"text-xs font-semibold tracking-wide text-gray-400 uppercase flex items-center justify-center",children:c("devices.table.actions")})]}),t.jsx("div",{className:"divide-y divide-gray-50",children:V.map(l=>t.jsxs("div",{className:"grid grid-cols-4 lg:grid-cols-7 gap-6 px-2 py-2 hover:bg-gray-50/50 transition-colors items-center text-sm",children:[t.jsx("div",{className:"font-semibold text-gray-900 flex items-center",children:t.jsxs("a",{href:`/p/${l.name}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 cursor-pointer hover:text-gray-600 flex flex-col",children:[t.jsx("span",{className:"text-gray-900 font-medium",children:l.name}),l.contractId&&t.jsx("span",{className:"text-[8px] text-gray-400",children:l.contractId})]})}),R==="technical"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"text-emerald-600 flex items-center font-bold",children:["$",(l.monthPaid||0).toLocaleString()]}),t.jsxs("div",{className:`flex items-center font-bold ${l.monthDebt>0?"text-red-600":"text-gray-400"}`,children:["$",(l.monthDebt||0).toLocaleString()]}),t.jsx("div",{className:"text-gray-500 hidden lg:flex items-center",children:l.status?t.jsx("span",{className:"contract-active px-2 py-1 bg-emerald-50 text-emerald-600 rounded-md text-xs font-medium",children:l.status}):t.jsx("span",{className:"contract-none text-gray-300",children:"--"})}),t.jsx("div",{className:"text-blue-600 flex items-center font-bold pl-4",children:l.freeDays||0}),t.jsxs("div",{className:"flex items-center justify-center gap-3",children:[t.jsx("div",{className:`flex flex-col items-center justify-center ${l.cutOff?"text-red-500":l.ignition?"text-emerald-500":"text-gray-300"}`,children:t.jsxs("svg",{id:"motorStatusSvg",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32",className:"motor-icon-svg",style:{fill:"currentColor"},children:[t.jsx("title",{children:"Engine"}),t.jsx("path",{d:"M13.778 6.667v2.222h3.333v2.222h2.222v-2.222h3.333v-2.222h-8.889zM13.778 13.333c-0.3 0-0.579 0.121-0.79 0.321l-1.888 1.901h-2.878c-0.611 0-1.111 0.5-1.111 1.111v6.667c0 0.611 0.5 1.111 1.111 1.111h1.888l3.056 2.033c0.178 0.122 0.39 0.189 0.612 0.189h5.556c0.244 0 0.477-0.077 0.666-0.221l4.444-3.333c0.278-0.211 0.445-0.545 0.445-0.89v-7.778c0-0.611-0.5-1.111-1.111-1.111h-10zM27.111 14.444v6.667h2.222v-6.667h-2.222zM17.111 15.556v3.333h2.222l-3.333 5.556v-3.333h-2.222l3.333-5.556zM2.667 16.667v5.556h2.222v-5.556h-2.222z"})]})}),t.jsx("div",{className:`flex items-center gap-1 ${l.batteryLevel>70?"text-emerald-500":l.batteryLevel>30?"text-yellow-500":"text-red-500"}`,children:l.batteryLevel>70?t.jsx(Pe,{size:20}):l.batteryLevel>30?t.jsx(Fe,{size:20}):t.jsx(Le,{size:20,className:"animate-pulse"})})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-gray-500 hidden lg:flex items-center",children:l.driverName||"-"}),t.jsx("div",{className:"text-gray-700 flex items-center font-medium",children:l.dailyRate?`$${l.dailyRate.toLocaleString()}`:"-"}),t.jsxs("div",{className:"text-emerald-600 flex items-center font-bold",children:["$",(l.monthPaid||0).toLocaleString()]}),t.jsxs("div",{className:`flex items-center font-bold ${l.monthDebt>0?"text-red-600":"text-gray-400"}`,children:["$",(l.monthDebt||0).toLocaleString()]}),t.jsx("div",{className:"text-blue-600 flex items-center font-bold pl-4",children:l.freeDays||0}),t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium 
                                            ${l.statusColor==="red"?"bg-red-100 text-red-700":l.statusColor==="yellow"?"bg-yellow-100 text-yellow-700":"bg-emerald-100 text-emerald-700"}`,children:l.status||"Al día"})})]}),t.jsxs("div",{className:"flex items-center justify-center relative action-menu-container",children:[t.jsx("button",{className:" text-left  text-sm text-gray-700  flex items-center  transition-colors",onClick:N=>{N.stopPropagation(),D(l),A(null)},children:t.jsx(He,{size:16,className:"text-gray-500"})}),t.jsx("button",{className:" text-left px-4 py-2.5 text-sm text-gray-700  flex items-center  ",onClick:N=>{N.stopPropagation(),G(l),A(null)},children:t.jsx(ke,{size:16,className:"text-gray-500"})})]})]},l._id))})]}),V.length===0&&t.jsx("div",{className:"empty-state",children:t.jsx("p",{children:c("devices.emptyState")})}),t.jsx(qe,{isOpen:b,onClose:()=>g(!1),onSubmit:Y,formData:H,setFormData:U,isEditing:!!e}),t.jsx(tt,{isOpen:s,onClose:()=>n(!1),shareUrl:i,onCopy:P}),t.jsx(st,{isOpen:j,onClose:()=>v(!1),onConfirm:K,deviceId:C==null?void 0:C._id})]})};export{gt as default};
