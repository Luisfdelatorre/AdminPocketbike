<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Pago a PocketBike</title>
    <noscript>
    </noscript>
    <style>
        :root {
            --color-primary: #333;
            --color-secondary: #6b7280;
            --color-accent: #e81c74;
            --color-success: #10b981;
            --color-success-dark: #059669;
            --color-success-light: #e8f5e9;
            --color-danger: #d74f4f;
            --color-border: #e5e7eb;
            --color-bg-light: #f3f4f6;
            --color-bg-white: #f9fafb;
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 50px;
            --transition-base: all 0.3s ease;
            --transition-slow: all 0.4s ease
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f5f5f5;
            color: var(--color-primary);
            line-height: 1.6;
            overflow: hidden;
            touch-action: manipulation
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: var(--spacing-md);
            background: #fff;
            min-height: 100vh;
            overflow-y: hidden;
            position: relative;
        }

        /* ... existing styles ... */

        .logout-icon {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            background: transparent;
            border: none;
            color: var(--color-secondary);
            cursor: pointer;
            padding: var(--spacing-xs);
            border-radius: 50%;
            transition: var(--transition-base);
            z-index: 1000;
        }

        .deviceIdGroup {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--spacing-lg)
        }

        .hidden {
            display: none;
            width: 100%;
            height: 100%;
        }

        .screen {
            display: none;
            width: 100%;
            height: 100%;
        }

        .screen.active {
            display: block
        }

        .keypad-btn {
            display: flex;
            align-items: center;
            justify-content: center
        }

        .app-title,
        .form-group input[type=text] {
            color: var(--color-primary);
            font-size: 24px;
            text-align: center
        }

        .app-title {
            font-weight: 600;
            margin-bottom: var(--spacing-xl)
        }

        .form-group label {
            display: block;
            margin-bottom: var(--spacing-md);
            font-size: 24px;
            font-weight: 700;
            text-align: center
        }

        .name-input {
            font-family: inherit;
            font-size: 24px;
            background: var(--color-bg-light);
            border: 1px solid #ddd;
            color: var(--color-primary);
            width: 35%;
            padding: var(--spacing-sm);
            border-radius: var(--radius-sm);
            display: none;
        }

        .form-group input[type=text] {
            font-family: inherit;
            background: var(--color-bg-light);
            border: 1px solid #ddd;
            width: 60%;
            padding: var(--spacing-sm);
            border-radius: var(--radius-sm)
        }

        .form-group input[type=text]:focus {
            outline: 0;
            border-color: #a78bfa
        }

        #loginScreen .container {
            padding-top: var(--spacing-xl)
        }

        .login-form {
            max-width: 350px;
            margin: 0 auto
        }

        .pin-container {
            margin-bottom: var(--spacing-lg)
        }

        .pin-display {
            display: flex;
            gap: var(--spacing-sm);
            margin: var(--spacing-sm) 0 var(--spacing-lg);
            justify-content: center
        }

        .pin-box {
            width: 30px;
            height: 30px;
            background: var(--color-bg-light);
            border: 2px solid var(--color-border);
            border-radius: 25px;
            text-align: center;
            font-size: 40px;
            line-height: 60px;
            color: #4f4b4b
        }

        .pin-box.filled {
            border-color: #99f19a;
            background: #92a8c8
        }

        .numeric-keypad {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            margin: 0 auto var(--spacing-lg);
            max-width: 300px;
            -webkit-user-select: none;
               -moz-user-select: none;
                    user-select: none
        }

        .keypad-row {
            display: flex;
            justify-content: space-between;
            padding: 0 5px
        }

        .keypad-btn {
            width: 65px;
            height: 65px;
            border-radius: 50%;
            border: 2px solid #74c86a5e;
            background: var(--color-bg-white);
            font-size: 28px;
            color: #4f4b4b;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-base);
            -webkit-tap-highlight-color: transparent
        }

        .keypad-btn:active {
            border-color: #052e7e;
            transform: scale(1.2)
        }

        .backspace-btn {
            border-color: var(--color-border)
        }

        .keypad-btn:disabled {
            animation: float-waiting 2s infinite ease-in-out;
            cursor: not-allowed;
            pointer-events: none;
            touch-action: none;
            background: #e5e5e5;
            border-color: transparent;
        }

        /* Stagger animations for wave effect */
        .keypad-row:nth-child(1) .keypad-btn:disabled {
            animation-delay: 0s;
        }

        .keypad-row:nth-child(2) .keypad-btn:disabled {
            animation-delay: 0.2s;
        }

        .keypad-row:nth-child(3) .keypad-btn:disabled {
            animation-delay: 0.4s;
        }

        .keypad-row:nth-child(4) .keypad-btn:disabled {
            animation-delay: 0.6s;
        }

        .error-message {
            color: var(--color-danger);
            font-size: 14px;
            margin-top: 5px;
            text-align: center;
            min-height: 20px
        }

        /* Payment Screen Styles Extracted from main.css */

        /* Utilities */
        .text-center {
            text-align: center !important;
        }

        .text-muted {
            color: var(--color-secondary) !important;
        }

        .text-danger {
            color: var(--color-danger) !important;
        }

        .no-padding {
            padding: 0 !important;
        }

        .img-sm {
            width: 50px;
            height: 50px;
        }

        .img-md {
            width: 60px;
            height: 60px;
        }

        .important-reminder {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            margin: var(--spacing-lg) 0;
            transition: all 0.3s ease;
        }

        .reminder-text {
            font-size: 13px;
            color: #075985;
            line-height: 1.5;
        }

        .reminder-title {
            font-weight: 600;
            font-size: 15px;
            color: #0c4a6e;
            margin-bottom: var(--spacing-xs);
        }

        .reminder-content {
            flex: 1;
            text-align: left;
        }

        .reminder-icon {
            font-size: 28px;
            line-height: 1;
            flex-shrink: 0;
            animation: ring 2s ease-in-out infinite;
        }

        .WompiSafe {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: transparent;
            color: #4b5563;
            text-align: center;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.5px;
            z-index: 100;
            gap: 4px;
            pointer-events: none;
            padding-bottom: 5px;
        }

        /* Flex Center Group */
        .logo,
        .device-header,
        .nequi-icon-box,
        .WompiSafe,
        .success-icon-circle,
        .screenshot-number,
        .keypad-btn,
        .device-info,
        .country-code {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .app-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            text-align: center;
        }

        .success-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: var(--spacing-md);
        }

        .logo {
            gap: var(--spacing-md);
        }

        .logo .app-title {
            margin-bottom: 0 !important;
            text-align: left;
            font-size: 20px;
        }

        .logo img {
            border-radius: var(--radius-md);
            -o-object-fit: cover;
               object-fit: cover;
        }

        /* Buttons */
        .btn {
            width: 100%;
            padding: 14px var(--spacing-lg);
            border: none;
            border-radius: var(--radius-md);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-base);
            margin-bottom: var(--spacing-sm);
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-success {
            background: var(--color-success);
            color: white;
        }

        .btn-success:hover {
            background: var(--color-success-dark);
        }

        .btn-secondary {
            background: var(--color-border);
            color: #374151;
        }

        .btn-secondary:hover {
            background: #d1d5db;
        }

        .finish-btn {
            background: #2d2d2d;
            color: #ccff00;
            padding: 14px 40px;
            border-radius: var(--radius-full);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: var(--spacing-lg) auto 0;
            display: block;
            width: -moz-fit-content;
            width: fit-content;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border: none;
        }

        /* Payment Section */
        .phone-input-group {
            display: flex;
            background: white;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            overflow: hidden;
            margin-bottom: var(--spacing-lg);
            height: 60px;
            transition: var(--transition-slow);
        }

        .phone-input {
            width: 75%;
            border: none;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 1.5rem;
            background: transparent;
        }

        .country-code {
            background: var(--color-bg-light);
            border-right: 1px solid #ddd;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 14px;
            font-weight: 500;
            width: 25%;
            line-height: 1.2;
            transition: var(--transition-slow);
        }

        .payment-section,
        .device-info,
        .device-logo svg,
        .device-id,
        .payment-amount,
        .payment-amount .currency {
            transition: var(--transition-slow);
        }

        .payment-amount .currency {
            font-size: 32px;
            transition: var(--transition-slow);
        }

        .payment-amount .currency-code {
            font-size: 16px;
            font-weight: 400;
            color: #666;
            vertical-align: middle;
        }

        .device-info {
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .device-header {
            margin-bottom: 2px;
            gap: var(--spacing-xs);
        }

        .device-logo svg {
            width: 60px;
            height: 60px;
        }

        .device-id {
            font-size: 24px;
            font-weight: 700;
            color: var(--color-primary);
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            display: none;
        }

        .device-logo-container {
            position: relative;
            display: inline-block;
        }

        .device-logo-container img {
            border-radius: var(--radius-md);
            -o-object-fit: cover;
               object-fit: cover;
            display: block;
        }

        .device-logo-container .status-ring {
            position: absolute;
            inset: -3px;
            border-radius: var(--radius-md);
            border: 3px solid transparent;
            pointer-events: none;
            transition: var(--transition-base);
        }

        .device-logo-container .status-ring.online {
            border-color: #22c55e;
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.3);
        }

        .device-logo-container .status-ring.offline {
            border-color: #ef4444;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
        }

        .device-logo-container .status-icons-container {
            position: absolute;
            bottom: -15px;
            right: -15px;
            z-index: 5;
            pointer-events: none;
        }

        .device-logo-container .status-icon {
            width: 50px;
            height: 28px;
            background: #ffffffeb;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
            pointer-events: auto;
            padding: 0 4px;
        }

        .device-logo-container .status-icon svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
            color: #9ca3af;
            transition: color 0.3s ease;
        }

        #batteryStatusSvg.high {
            color: #22c55e;
        }

        #batteryStatusSvg.medium {
            color: #eab308;
        }

        #batteryStatusSvg.low {
            color: #ef4444;
        }

        #motorStatusSvg.green {
            color: #22c55e;
        }

        #motorStatusSvg.red {
            color: #ef4444;
        }

        .payment-amount {
            text-align: center;
            margin: var(--spacing-lg) 0;
            font-size: 48px;
            font-weight: 700;
            color: #555;
            line-height: 1;
        }



        .nequi-divider {
            width: 1px;
            height: 40px;
            background-color: #ccc;
            margin: 0 var(--spacing-md);
        }

        .nequi-payment-card {
            width: 100%;
            display: flex;
            align-items: center;
            background: white;
            border: 2px solid #089270;
            border-radius: var(--radius-md);
            padding: var(--spacing-sm) var(--spacing-md);
            cursor: pointer;
            transition: var(--transition-slow);
            margin-bottom: var(--spacing-sm);
            height: 70px;
        }

        .nequi-payment-card:hover {
            border-color: #bdbdbd;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .nequi-payment-card:active {
            transform: scale(0.98);
        }

        .nequi-icon-box {
            width: 60px;
        }

        .nequi-icon-box img {
            height: 30px;
            width: auto;
            -o-object-fit: contain;
               object-fit: contain;
        }

        .nequi-text {
            flex: 1;
            text-align: center;
            color: #212529;
            font-size: 16px;
        }



        /* Options & History */
        .more-options {
            text-align: center;
            margin: var(--spacing-sm) 0;
        }

        .more-options a {
            color: var(--color-secondary);
            text-decoration: none;
            font-size: 14px;
            cursor: pointer;
        }
    </style>
    <script>
        function _getDeviceIdFromUrl() {
            const path = window.location.pathname;
            const match = path.match(/\/p\/([^\/]+)/);
            return match ? match[1] : null;
        }

    </script>
    <!-- Scripts -->

  <script type="module" crossorigin src="/assets/payment-jKtK_NWZ.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/modulepreload-polyfill-B5Qt9EMX.js">
  <link rel="stylesheet" crossorigin href="/assets/payment-BJ-CKM7W.css">
</head>

<body>
    <!-- Screen Containers (populated dynamically by component loader) -->
    <div id="loginScreen" class="screen">
        <div class="container">
            <h2 class="app-title">Pago a PocketBike</h2>
            <div class="login-form">
                <div class="deviceIdGroup" id="deviceIdGroup">
                    <img alt="PocketBike Logo" src="/pocketbike_60x60.jpg"
                        style="background: #f3f4f6; min-width: 60px; min-height: 60px; display: block;">
                    <input type="text" id="deviceId" placeholder="Placa" class="name-input hidden" required>
                    <div id="deviceIdDisplay" class="device-id "></div>
                    <script>
                        (function () {
                            const urlDeviceId = _getDeviceIdFromUrl();
                            const deviceIdDisplay = document.getElementById('deviceIdDisplay');
                            const deviceIdInput = document.getElementById('deviceId');
                            deviceIdInput.value = urlDeviceId;
                            deviceIdInput.disabled = true;
                            deviceIdInput.style.display = 'none';

                            if (deviceIdDisplay && urlDeviceId) {
                                deviceIdDisplay.textContent = urlDeviceId;
                                deviceIdDisplay.style.display = 'block';
                            } else {
                                deviceIdInput.disabled = false;
                                deviceIdInput.classList.remove('hidden');
                                deviceIdInput.style.display = 'block';
                            }
                        })();


                    </script>
                </div>

                <div class="form-group pin-container">
                    <label class="pin-title">Escribe tu clave</label>
                    <div class="pin-display" id="pinDisplay">
                        <input type="password" class="pin-box" readonly>
                        <input type="password" class="pin-box" readonly>
                        <input type="password" class="pin-box" readonly>
                        <input type="password" class="pin-box" readonly>
                    </div>
                    <input type="password" id="devicePin" maxlength="4" class="hidden">
                </div>

                <div class="numeric-keypad" id="numericKeypad">
                    <div class="keypad-row">
                        <button class="keypad-btn" data-val="1" disabled>1</button>
                        <button class="keypad-btn" data-val="2" disabled>2</button>
                        <button class="keypad-btn" data-val="3" disabled>3</button>
                    </div>
                    <div class="keypad-row">
                        <button class="keypad-btn" data-val="4" disabled>4</button>
                        <button class="keypad-btn" data-val="5" disabled>5</button>
                        <button class="keypad-btn" data-val="6" disabled>6</button>
                    </div>
                    <div class="keypad-row">
                        <button class="keypad-btn" data-val="7" disabled>7</button>
                        <button class="keypad-btn" data-val="8" disabled>8</button>
                        <button class="keypad-btn" data-val="9" disabled>9</button>
                    </div>
                    <div class="keypad-row">
                        <button class="keypad-btn backspace-btn" id="keypadClear" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path
                                    d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                </path>
                            </svg>
                        </button>
                        <button class="keypad-btn" data-val="0" disabled>0</button>
                        <button class="keypad-btn backspace-btn" id="keypadBackspace" disabled>âŒ«</button>
                    </div>
                </div>
                <div id="loginError" class="error-message"></div>
            </div>
        </div>

    </div>
    <!-- Toast Notification Container -->
    <div id="toastContainer"></div>
    <div id="paymentScreen" class="screen ">
        <div class="container">
            <div id="paymentSection" class="payment-section">
                <h2 class="app-title">Pago a PocketBike</h2>
                <button id="logoutBtn" class="logout-icon" title="Cerrar SesiÃ³n">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                </button>
                <div class="device-header">
                    <div class="device-logo-container">
                        <img alt="PocketBike Logo" src="/pocketbike_60x60.jpg" class="img-sm">
                        <div class="status-ring" id="deviceStatusRing"></div>
                        <div class="status-icons-container">
                            <div class="status-icon ">
                                <svg id="batteryStatusSvg" class="" focusable="false" aria-hidden="true"
                                    viewBox="0 0 24 24" data-testid="BatteryFullIcon">
                                    <path
                                        d="M15.67 4H14V2h-4v2H8.33C7.6 4 7 4.6 7 5.33v15.33C7 21.4 7.6 22 8.33 22h7.33c.74 0 1.34-.6 1.34-1.33V5.33C17 4.6 16.4 4 15.67 4">
                                    </path>
                                </svg>
                                <svg id="motorStatusSvg" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                    viewBox="0 0 32 32" class="motor-icon-svg">
                                    <title>Engine</title>
                                    <path fill="currentColor"
                                        d="M13.778 6.667v2.222h3.333v2.222h2.222v-2.222h3.333v-2.222h-8.889zM13.778 13.333c-0.3 0-0.579 0.121-0.79 0.321l-1.888 1.901h-2.878c-0.611 0-1.111 0.5-1.111 1.111v6.667c0 0.611 0.5 1.111 1.111 1.111h1.888l3.056 2.033c0.178 0.122 0.39 0.189 0.612 0.189h5.556c0.244 0 0.477-0.077 0.666-0.221l4.444-3.333c0.278-0.211 0.445-0.545 0.445-0.89v-7.778c0-0.611-0.5-1.111-1.111-1.111h-10zM27.111 14.444v6.667h2.222v-6.667h-2.222zM17.111 15.556v3.333h2.222l-3.333 5.556v-3.333h-2.222l3.333-5.556zM2.667 16.667v5.556h2.222v-5.556h-2.222z">
                                    </path>
                                </svg>

                            </div>

                        </div>
                    </div>
                    <span class="device-id" id="deviceDisplay">AAA00X</span>
                    <span id="paymentDueDate" class="text-muted payment-date-style">- ---</span>
                </div>
                <script>
                    (function () {
                        const urlDeviceId = _getDeviceIdFromUrl();
                        const deviceIdDisplay = document.getElementById('deviceDisplay');

                        if (deviceIdDisplay && urlDeviceId) {
                            deviceIdDisplay.textContent = urlDeviceId;
                            deviceIdDisplay.style.display = 'block';
                        }
                    })();


                </script>
                <div class="payment-amount">
                    <span class="currency">$</span><span id="paymentAmount">35.000</span><span
                        class="currency-code">COP</span>
                </div>
                <div class="phone-input-group">
                    <div class="country-code">Nequi<br>+57</div>
                    <input type="tel" id="phoneNumber" class="phone-input" placeholder="300 756 0069"
                        inputmode="numeric">
                </div>
                <button id="nequiPayBtn" class="nequi-payment-card">
                    <div class="nequi-icon-box">
                        <img src="/nequi.png" alt="Nequi" class="img-sm">
                    </div>
                    <div class="nequi-divider"></div>
                    <div class="nequi-text">Pagar con tu cuenta Nequi</div>
                </button>
            </div>
            <div class="more-options">
                <a href="#" id="morePaymentOptions">MÃ¡s formas de pago â–¼</a>
            </div>

            <div class="important-reminder" id="normalReminder">
                <div class="reminder-icon">ðŸ””</div>
                <div class="reminder-content">
                    <div class="reminder-title">CÃ³mo pagar</div>
                    <div class="reminder-text">DespuÃ©s de hacer clic en "Pagar", completa tu transacciÃ³n en el centro de
                        notificaciones de Nequi.</div>
                </div>
            </div>


            <div class="WompiSafe">
                PAGOS SEGUROS POR <img alt="Wompi" src="/assets/wompi-DoOQSKMm.svg">
            </div>
        </div>
    </div>

    <script>
        (function () {
            try {
                const token = sessionStorage.getItem('paymentAuthToken');
                const paymentScreen = document.getElementById('paymentScreen');
                const loginScreen = document.getElementById('loginScreen');
                if (token) {
                    if (paymentScreen) {
                        paymentScreen.classList.add('active');
                        paymentScreen.style.display = 'block';
                    }
                    if (loginScreen) {
                        loginScreen.classList.remove('active');
                        loginScreen.style.display = 'none';
                    }
                } else {
                    if (loginScreen) {
                        loginScreen.classList.add('active');
                        loginScreen.style.display = 'block';
                    }
                    if (paymentScreen) {
                        paymentScreen.classList.remove('active');
                        paymentScreen.style.display = 'none';
                    }
                }
            } catch (e) {
                console.error('Error in initial screen decision:', e);
                const loginScreen = document.getElementById('loginScreen');
                if (loginScreen) loginScreen.classList.add('active');
            }
        })();
    </script>



</body>

</html>